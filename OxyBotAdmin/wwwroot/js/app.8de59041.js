(function(e){function t(t){for(var a,i,o=t[0],c=t[1],l=t[2],u=0,h=[];u<o.length;u++)i=o[u],n[i]&&h.push(n[i][0]),n[i]=0;for(a in c)Object.prototype.hasOwnProperty.call(c,a)&&(e[a]=c[a]);d&&d(t);while(h.length)h.shift()();return r.push.apply(r,l||[]),s()}function s(){for(var e,t=0;t<r.length;t++){for(var s=r[t],a=!0,o=1;o<s.length;o++){var c=s[o];0!==n[c]&&(a=!1)}a&&(r.splice(t--,1),e=i(i.s=s[0]))}return e}var a={},n={app:0},r=[];function i(t){if(a[t])return a[t].exports;var s=a[t]={i:t,l:!1,exports:{}};return e[t].call(s.exports,s,s.exports,i),s.l=!0,s.exports}i.m=e,i.c=a,i.d=function(e,t,s){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},i.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(i.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)i.d(s,a,function(t){return e[t]}.bind(null,a));return s},i.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],c=o.push.bind(o);o.push=t,o=o.slice();for(var l=0;l<o.length;l++)t(o[l]);var d=c;r.push([0,"chunk-vendors"]),s()})({0:function(e,t,s){e.exports=s("56d7")},"02b8":function(e,t,s){"use strict";var a=s("9e76"),n=s.n(a);n.a},"034d":function(e,t,s){},"034f":function(e,t,s){"use strict";var a=s("64a9"),n=s.n(a);n.a},"0652":function(e,t,s){},"0dd2":function(e,t,s){},"326b":function(e,t,s){"use strict";var a=s("990b"),n=s.n(a);n.a},"328c":function(e,t,s){"use strict";var a=s("ac98"),n=s.n(a);n.a},"32cd":function(e,t,s){"use strict";var a=s("df10"),n=s.n(a);n.a},"34d4":function(e,t,s){"use strict";var a=s("3e10"),n=s.n(a);n.a},"3e10":function(e,t,s){},"544a":function(e,t,s){"use strict";var a=s("0652"),n=s.n(a);n.a},"56d7":function(e,t,s){"use strict";s.r(t);s("744f"),s("6c7b"),s("7514"),s("20d6"),s("1c4c"),s("6762"),s("cadf"),s("e804"),s("55dd"),s("d04f"),s("c8ce"),s("217b"),s("7f7f"),s("f400"),s("7f25"),s("536b"),s("d9ab"),s("f9ab"),s("32d7"),s("25c9"),s("9f3c"),s("042e"),s("c7c6"),s("f4ff"),s("049f"),s("7872"),s("a69f"),s("0b21"),s("6c1a"),s("c7c62"),s("84b4"),s("c5f6"),s("2e37"),s("fca0"),s("7cdf"),s("ee1d"),s("b1b1"),s("87f3"),s("9278"),s("5df2"),s("04ff"),s("f751"),s("4504"),s("fee7"),s("ffc1"),s("0d6d"),s("9986"),s("8e6e"),s("25db"),s("e4f7"),s("b9a1"),s("64d5"),s("9aea"),s("db97"),s("66c8"),s("57f0"),s("165b"),s("456d"),s("cf6a"),s("fd24"),s("8615"),s("551c"),s("097d"),s("df1b"),s("2397"),s("88ca"),s("ba16"),s("d185"),s("ebde"),s("2d34"),s("f6b3"),s("2251"),s("c698"),s("a19f"),s("9253"),s("9275"),s("3b2b"),s("3846"),s("4917"),s("a481"),s("28a5"),s("386d"),s("6b54"),s("4f7f"),s("8a81"),s("ac4d"),s("8449"),s("9c86"),s("fa83"),s("48c0"),s("a032"),s("aef6"),s("d263"),s("6c37"),s("9ec8"),s("5695"),s("2fdb"),s("d0b0"),s("5df3"),s("b54a"),s("f576"),s("ed50"),s("788d"),s("14b9"),s("f386"),s("f559"),s("1448"),s("673e"),s("242a"),s("c66f"),s("b05c"),s("34ef"),s("6aa2"),s("15ac"),s("af56"),s("b6e4"),s("9c29"),s("63d9"),s("4dda"),s("10ad"),s("c02b"),s("4795"),s("130f"),s("ac6a"),s("96cf");var a=s("2b0e"),n=s("bc3a"),r=s.n(n),i={baseURL:"/",timeout:108e5},o=r.a.create(i);o.interceptors.request.use(function(e){return e},function(e){return Promise.reject(e)}),o.interceptors.response.use(function(e){return e},function(e){return Promise.reject(e)}),Plugin.install=function(e,t){e.axios=o,window.axios=o,Object.defineProperties(e.prototype,{axios:{get:function(){return o}},$axios:{get:function(){return o}}})},a["a"].use(Plugin);Plugin;var c=s("9f7b"),l=s("7b38");s("ab8b"),s("2dd8");a["a"].use(c["a"]),a["a"].use(l["Navbar"]);var d=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{attrs:{id:"app"}},[s("router-view")],1)},u=[],h=(s("034f"),s("2877")),g={},f=Object(h["a"])(g,d,u,!1,null,null,null),m=f.exports,p=s("8c4f"),w=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("b-container",[a("b-row",[a("b-col",{attrs:{md:"4","offset-md":"4"}},[a("div",{staticClass:"form-body"},[a("b-form",{attrs:{id:"bForm"},on:{submit:e.onSubmit}},[a("img",{attrs:{id:"img-logo",src:s("cf05"),alt:"OxyMedLogo",width:"125",height:"72.75"}}),a("b-form-group",{attrs:{label:"Ваш логин","label-for":"loginInput"}},[a("b-form-input",{attrs:{id:"loginInput",required:"",type:"text"},model:{value:e.login,callback:function(t){e.login=t},expression:"login"}})],1),a("b-form-group",{attrs:{label:"Ваш пароль","label-for":"passInput"}},[a("b-form-input",{attrs:{id:"passInput",required:"",type:"password"},model:{value:e.pass,callback:function(t){e.pass=t},expression:"pass"}})],1),a("b-alert",{attrs:{variant:"danger",dismissible:"",show:e.showAlert},on:{dismissed:function(t){e.showAlert=!e.showAlert}}},[e._v("\r\n            "+e._s(e.message)+" \r\n        ")]),a("b-button",{attrs:{id:"submit-button",type:"submit",variant:"primary"},on:{click:function(t){return t.preventDefault(),e.onSubmit(t)}}},[e._v("Войти")])],1)],1)])],1)],1)},b=[],v=s("0596"),S=s("0903"),A=s("ebd1"),x=s("ad48"),_=s("a198"),y="/login/auth",k={components:{BForm:v["a"],BFormText:S["a"],BFormInvalidFeedback:A["a"],BFormValidFeedback:x["a"],BFormRow:_["a"]},data:function(){return{login:"",pass:"",showAlert:!1,message:""}},methods:{onSubmit:function(){var e=this;if(!this.login)return this.message="Введите логин!",void(this.showAlert=!0);if(!this.pass)return this.message="Введите пароль!",void(this.showAlert=!0);var t={login:this.login,password:this.pass};a["a"].axios.post(y,t).then(function(t){var s="Bearer "+t.data.token;sessionStorage.setItem("userToken",s),a["a"].axios.defaults.headers.common["Authorization"]=s,a["a"].axios.defaults.headers.common["Content-Type"]="application/json",a["a"].axios.interceptors.request.use(function(e){if(t.data.token)return e.headers["Authorization"]=s,e.headers["Content-Type"]="application/json",e}),e.$router.push({name:"sendMessageToUsers"})}).catch(function(t){t.response&&403===t.response.status?(e.error=!0,e.message="Неверный логин или пароль!"):(e.error=!0,e.message="Произошла непредвиденная ошибка!"),e.showAlert=!0})}}},E=k,P=(s("02b8"),Object(h["a"])(E,w,b,!1,null,null,null)),D=P.exports,I=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("nav-bar"),s("h1",{staticStyle:{"margin-top":"8%","margin-bottom":"2%"}},[e._v(e._s(e.headerLabel))]),s("div",[s("b-container",{staticStyle:{"margin-top":"15pt"}},[s("b-form-group",[s("b-form-textarea",{staticStyle:{"border-color":"#0275D8"},attrs:{rows:7,"max-rows":10,placeholder:"Введите текст для рассылки"},model:{value:e.message4Send,callback:function(t){e.message4Send=t},expression:"message4Send"}})],1),s("b-button",{attrs:{disabled:e.isSendButtonDisabled,variant:"danger"},on:{click:e.sendMsg2AllUsers}},[e._v("Отправить сообщение")]),s("b-alert",{attrs:{variant:"danger",dismissible:"",fade:"",show:e.showDangerAlert},on:{dismissed:function(t){e.showDangerAlert=!e.showDangerAlert}}},[e._v(e._s(e.alertMessage))]),s("b-alert",{attrs:{variant:"success",dismissible:"",fade:"",show:e.showSuccessAlert},on:{dismissed:function(t){e.showSuccessAlert=!e.showSuccessAlert}}},[e._v(e._s(e.alertMessage))]),s("b-alert",{attrs:{variant:"warning",dismissible:"",fade:"",show:e.showWarningAlert},on:{dismissed:function(t){e.showWarningAlert=!e.showWarningAlert}}},[e._v(e._s(e.alertMessage))])],1)],1)],1)},C=[],U=s("a34a"),M=s.n(U),W=s("bd61");function T(e,t,s,a,n,r,i){try{var o=e[r](i),c=o.value}catch(l){return void s(l)}o.done?t(c):Promise.resolve(c).then(a,n)}function N(e){return function(){var t=this,s=arguments;return new Promise(function(a,n){var r=e.apply(t,s);function i(e){T(r,a,n,i,o,"next",e)}function o(e){T(r,a,n,i,o,"throw",e)}i(void 0)})}}var L={message:"",isSucessfully:!1},O={sendMessageToAllUsers:function(){var e=N(M.a.mark(function e(t){var s,n,r=arguments;return M.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(s=r.length>1&&void 0!==r[1]?r[1]:"/api/send/msg",e.prev=1,t){e.next=4;break}throw new Error("Для отправки сообщения необходимо указать его текст!");case 4:if(s){e.next=6;break}throw new Error("Url required for sending message");case 6:return e.next=8,a["a"].axios.post(s,JSON.stringify(t));case 8:return n=e.sent,L.isSucessfully=!0,n&&n.data&&n.data.message?L.message=n.data.message:L.message="Сообщение успешно отправлено!",e.abrupt("return",L);case 14:e.prev=14,e.t0=e["catch"](1),L.isSucessfully=!1,e.t0.response?L.message=e.t0.response.data:L.message="Something goes wrong! Please try again later!";case 18:case"end":return e.stop()}},e,this,[[1,14]])}));function t(t){return e.apply(this,arguments)}return t}()};function R(e,t,s,a,n,r,i){try{var o=e[r](i),c=o.value}catch(l){return void s(l)}o.done?t(c):Promise.resolve(c).then(a,n)}function V(e){return function(){var t=this,s=arguments;return new Promise(function(a,n){var r=e.apply(t,s);function i(e){R(r,a,n,i,o,"next",e)}function o(e){R(r,a,n,i,o,"throw",e)}i(void 0)})}}var B={components:{NavBar:W["default"]},data:function(){return{message4Send:"",headerLabel:"Рассылка сообщения пользователям",isSendButtonDisabled:!1,showDangerAlert:!1,showWarningAlert:!1,showSuccessAlert:!1,alertMessage:""}},methods:{sendMsg2AllUsers:function(){var e=V(M.a.mark(function e(){var t,s;return M.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(e.prev=0,t=this.message4Send,!t){e.next=12;break}return this.isSendButtonDisabled=!0,this.alertMessage="Рассылка сообщения, подождите и не закрывайте окно браузера!",this.showWarningAlert=!0,e.next=8,O.sendMessageToAllUsers(t);case 8:s=e.sent,s.isSucessfully?(this.showSuccessAlert=!0,this.alertMessage=s.message?s.message:"Сообщение успешно отправлено!"):(this.showDangerAlert=!0,this.alertMessage=s.message?s.message:"Сообщение не отправлено!"),e.next=14;break;case 12:this.alertMessage="Введите текст сообщения!",this.showDangerAlert=!0;case 14:e.next=20;break;case 16:e.prev=16,e.t0=e["catch"](0),this.showDangerAlert=!0,this.alertMessage="Произошла непредвиденная ошибка!";case 20:this.isSendButtonDisabled=!1;case 21:case"end":return e.stop()}},e,this,[[0,16]])}));function t(){return e.apply(this,arguments)}return t}()},watch:{showDangerAlert:function(e){e&&(this.showWarningAlert=!1,this.showSuccessAlert=!1)},showWarningAlert:function(e){e&&(this.showDangerAlert=!1,this.showSuccessAlert=!1)},showSuccessAlert:function(e){e&&(this.showWarningAlert=!1,this.showSuccessAlert=!1)},alertMessage:function(e){e||(this.showDangerAlert=!1,this.showWarningAlert=!1,this.showSuccessAlert=!1)}}},F=B,j=(s("5ba7"),Object(h["a"])(F,I,C,!1,null,null,null)),q=j.exports,$=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("nav-bar"),s("b-container",[s("h2",[e._v(e._s(e.headerLabel))]),s("b-form-group",[s("b-row",[s("b-col",{attrs:{md:"6","offset-md":"3"}},[s("b-img",{directives:[{name:"show",rawName:"v-show",value:e.isImagePreviewShowing,expression:"isImagePreviewShowing"}],ref:"img-4-send",attrs:{src:e.img_src,fluid:"",alt:"Выберите изображение"}})],1)],1)],1),s("b-form-group"),s("b-form-group",[s("b-row",[s("b-col",{attrs:{md:"6","offset-md":"3"}},[s("b-form-textarea",{attrs:{rows:7,"max-rows":7,placeholder:"Введите текст к картинке/файлу, не более 1024 символов"},model:{value:e.message4Img,callback:function(t){e.message4Img=t},expression:"message4Img"}}),s("b-alert",{attrs:{variant:"warning",dismissible:"",show:e.showWarningAlert},on:{dismissed:function(t){e.showWarningAlert=!e.showWarningAlert}}},[e._v("\r\n                        "+e._s(e.alertMessage)+"\r\n                    ")]),s("b-alert",{attrs:{variant:"danger",dismissible:"",show:e.showDangerAlert},on:{dismissed:function(t){e.showDangerAlert=!e.showDangerAlert}}},[e._v("\r\n                        "+e._s(e.alertMessage)+"\r\n                    ")]),s("b-alert",{attrs:{variant:"success",dismissible:"",show:e.showSuccessAlert},on:{dismissed:function(t){e.showSuccessAlert=!e.showSuccessAlert}}},[e._v("\r\n                        "+e._s(e.alertMessage)+"\r\n                    ")])],1)],1)],1),s("b-form-group",{staticStyle:{"text-align":"center"}},[s("b-row",[s("b-col",{attrs:{md:"6","offset-md":"3"}},[s("b-form-group",[s("b-form-file",{directives:[{name:"show",rawName:"v-show",value:e.isImageChooseShowing,expression:"isImageChooseShowing"}],ref:"imageInput",attrs:{state:Boolean(e.selectedImg),accept:"image/jpeg, image/png",placeholder:"Выберите изображение!","drop-placeholder":"Перетащите файл сюда!"},on:{change:e.imageSelected},model:{value:e.selectedImg,callback:function(t){e.selectedImg=t},expression:"selectedImg"}})],1),s("b-form-group",[s("b-form-file",{directives:[{name:"show",rawName:"v-show",value:e.isFileChooseShowing,expression:"isFileChooseShowing"}],ref:"fileInput",attrs:{state:Boolean(e.fileForSend),placeholder:"Выберите файл!","drop-placeholder":"Перетащите файл сюда!"},on:{change:e.fileChoosed},model:{value:e.fileForSend,callback:function(t){e.fileForSend=t},expression:"fileForSend"}})],1)],1),s("b-col",{attrs:{md:"6","offset-md":"3"}},[s("input",{ref:"input_img",staticStyle:{display:"none"},attrs:{type:"file"},on:{change:e.imageSelected}}),s("b-btn-group",{staticStyle:{"margin-left":"5px"}},[e.showSendBtn?s("b-button",{attrs:{disabled:e.isSendButtonDisabled,variant:"danger"},on:{click:e.send}},[e._v("Отправить!")]):e._e()],1),s("b-btn-group",{staticStyle:{"margin-left":"5px"}},[e.showSendBtn?s("b-button",{attrs:{disabled:e.isSendButtonDisabled},on:{click:e.cancel}},[e._v("Отмeна")]):e._e()],1)],1)],1)],1)],1)],1)},z=[];function J(e,t,s,a,n,r,i){try{var o=e[r](i),c=o.value}catch(l){return void s(l)}o.done?t(c):Promise.resolve(c).then(a,n)}function Q(e){return function(){var t=this,s=arguments;return new Promise(function(a,n){var r=e.apply(t,s);function i(e){J(r,a,n,i,o,"next",e)}function o(e){J(r,a,n,i,o,"throw",e)}i(void 0)})}}var G={message:"",isSucessfully:!1},Y={sendImageToAllUsers:function(){var e=Q(M.a.mark(function e(t){var s,n,r,i=arguments;return M.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(s=i.length>1&&void 0!==i[1]?i[1]:"/api/send/img",e.prev=1,t){e.next=4;break}throw new Error("Для отправки сообщения необходимо указать его текст!");case 4:if(t.image){e.next=6;break}throw new Error("Couldn't send empty image!");case 6:if(s){e.next=8;break}throw new Error("Url is required for sending image!");case 8:return n=new FormData,n.append("file",t.image),n.append("message",t.textForImage),e.next=13,a["a"].axios.post(s,n,{headers:{"Content-Type":"multipart/form-data"}});case 13:return r=e.sent,r&&r.data&&r.data.message?G.message=r.data.message:G.message="Изображение успешно отправлено!",G.isSucessfully=!0,e.abrupt("return",G);case 19:e.prev=19,e.t0=e["catch"](1),G.isSucessfully=!1,e.t0.response&&e.t0.response.data?G.message=e.t0.response.data:G.message="Изображение не загружено!";case 23:case"end":return e.stop()}},e,this,[[1,19]])}));function t(t){return e.apply(this,arguments)}return t}(),sendFileToAllUsers:function(){var e=Q(M.a.mark(function e(t){var s,n,r,i=arguments;return M.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(s=i.length>1&&void 0!==i[1]?i[1]:"/api/send/file",e.prev=1,t){e.next=4;break}throw new Error("Для отправки сообщения необходимо указать его текст!");case 4:if(t.file){e.next=6;break}throw new Error("Couldn't send empty image!");case 6:if(s){e.next=8;break}throw new Error("Url is required for sending image!");case 8:return n=new FormData,n.append("file",t.file),n.append("message",t.textForFile),e.next=13,a["a"].axios.post(s,n,{headers:{"Content-Type":"multipart/form-data"}});case 13:r=e.sent,r&&r.data&&r.data.message?G.message=r.data.message:G.message="Файл успешно отправлен!",G.isSucessfully=!0,e.next=22;break;case 18:e.prev=18,e.t0=e["catch"](1),G.isSucessfully=!1,e.t0.response&&e.t0.response.data?G.message=e.t0.response.data:G.message="Файл не загружен!"+e.t0.toString();case 22:return e.abrupt("return",G);case 23:case"end":return e.stop()}},e,this,[[1,18]])}));function t(t){return e.apply(this,arguments)}return t}()};function H(e,t,s,a,n,r,i){try{var o=e[r](i),c=o.value}catch(l){return void s(l)}o.done?t(c):Promise.resolve(c).then(a,n)}function K(e){return function(){var t=this,s=arguments;return new Promise(function(a,n){var r=e.apply(t,s);function i(e){H(r,a,n,i,o,"next",e)}function o(e){H(r,a,n,i,o,"throw",e)}i(void 0)})}}var X={components:{NavBar:W["default"]},data:function(){return{img_src:"",alertMessage:"",message4Img:"",showDangerAlert:!1,showWarningAlert:!1,showSuccessAlert:!1,headerLabel:"Рассылка файла или изображения пользователям",selectedImg:null,fileForSend:null,isSendButtonDisabled:!1,isFileChooseShowing:!0,isImageChooseShowing:!0,isImagePreviewShowing:!1}},methods:{imageSelected:function(e){e.target.files&&0!==e.target.files.length&&e.target.files[0]&&(this.selectedImg=e.target.files[0],this.img_src=URL.createObjectURL(this.selectedImg))},fileChoosed:function(e){e.target.files&&0!==e.target.files.length&&e.target.files[0]&&(this.fileForSend=e.target.files[0])},send:function(){var e=K(M.a.mark(function e(){var t,s,a;return M.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(e.prev=0,this.selectedImg||this.fileForSend||(this.showDangerAlert=!0,this.messageFromServer="Изображение или файл не выбраны!"),this.message4Img&&this.message4Img.length>1024&&(this.showDangerAlert=!0,this.messageFromServer="Текст к картинке или файлу не может содержать более 1024 символов!"),this.isSendButtonDisabled=!0,this.showWarningAlert=!0,this.alertMessage="Идёт рассылка... Не закрывайте окно браузера!",t=null,!this.selectedImg||this.fileForSend){e.next=14;break}return s={image:this.selectedImg,textForImage:this.message4Img?this.message4Img:""},e.next=11,Y.sendImageToAllUsers(s);case 11:t=e.sent,e.next=22;break;case 14:if(this.selectedImg||!this.fileForSend){e.next=21;break}return a={file:this.fileForSend,textForFile:this.message4Img?this.message4Img:""},e.next=18,Y.sendFileToAllUsers(a);case 18:t=e.sent,e.next=22;break;case 21:throw new Error("Something goes wrong!");case 22:this.alertMessage=t.message,t.isSucessfully?(this.showSuccessAlert=!0,this.img_src="",this.message4Img="",this.selectedImg=null,this.fileForSend=null,this.isFileChooseShowing,this.isImageChooseShowing=!0):this.showDangerAlert=!0,e.next=30;break;case 26:e.prev=26,e.t0=e["catch"](0),this.showDangerAlert=!0,this.alertMessage="Произошла непредвиденная ошибка!";case 30:this.isSendButtonDisabled=!1;case 31:case"end":return e.stop()}},e,this,[[0,26]])}));function t(){return e.apply(this,arguments)}return t}(),cancel:function(){this.selectedImg=null,this.fileForSend=null,this.isSendButtonDisabled=!1,this.isFileChooseShowing=!0,this.isImageChooseShowing=!0,this.isImagePreviewShowing=!1,this.$refs.imageInput.reset(),this.$refs.fileInput.reset()}},computed:{showSendBtn:function(){return!(!this.selectedImg&&!this.fileForSend)}},watch:{showDangerAlert:function(e){e&&(this.showWarningAlert=!1,this.showSuccessAlert=!1)},showWarningAlert:function(e){e&&(this.showDangerAlert=!1,this.showSuccessAlert=!1)},showSuccessAlert:function(e){e&&(this.showWarningAlert=!1,this.showSuccessAlert=!1)},fileForSend:function(e){e?(this.selectedImg=null,this.isImageChooseShowing=!1,this.img_src=""):this.isImageChooseShowing=!0},selectedImg:function(e){e?(this.fileForSend=null,this.isFileChooseShowing=!1):(this.isFileChooseShowing=!0,this.img_src="")},img_src:function(e){this.isImagePreviewShowing=!!e},alertMessage:function(e){e||(this.showDangerAlert=!1,this.showWarningAlert=!1,this.showSuccessAlert=!1)}}},Z=X,ee=(s("f8d1"),Object(h["a"])(Z,$,z,!1,null,null,null)),te=ee.exports,se=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("nav-bar"),s("loading",{attrs:{isLoading:e.isLoading}}),e.isLoading?e._e():s("b-container",[s("b-table",{attrs:{"primary-key":"chatId",bordered:"",hover:"",fields:e.tableData.fields,items:e.tableData.items,"head-variant":"light",responsive:"","caption-top":""},scopedSlots:e._u([{key:"messageForUser",fn:function(t){return[s("a",{attrs:{href:"#"},on:{click:function(s){e.selectedUser=t.item,e.isSendMessageWindowShowing=!0}}},[s("i",{staticClass:"material-icons"},[e._v("create")])])]}}])},[s("template",{slot:"table-caption"},[s("strong",{staticClass:"text-danger"},[e._v("Кол-во пользователей бота: "+e._s(e.botUsersTotalCount))])])],2),s("b-pagination",{staticStyle:{"margin-bottom":"5%"},attrs:{align:"center","total-rows":e.botUsersTotalCount,"per-page":e.dataRowsPerPage,limit:8},model:{value:e.currentPage,callback:function(t){e.currentPage=t},expression:"currentPage"}}),s("b-modal",{attrs:{title:e.modalTitle,centered:"","cancel-disabled":""},model:{value:e.isModalWindowShowing,callback:function(t){e.isModalWindowShowing=t},expression:"isModalWindowShowing"}},[s("p",[e._v(e._s(e.modalText))])]),s("b-modal",{attrs:{size:"lg",title:"Сообщение для: "+e.selectedUser.firstAndLastName,centered:""},model:{value:e.isSendMessageWindowShowing,callback:function(t){e.isSendMessageWindowShowing=t},expression:"isSendMessageWindowShowing"}},[s("b-container",[s("b-form-textarea",{staticStyle:{"border-color":"#0275D8"},attrs:{rows:7,"max-rows":10,placeholder:"Введите текст сообщения"},model:{value:e.messageForSend,callback:function(t){e.messageForSend=t},expression:"messageForSend"}}),s("b-alert",{attrs:{variant:"danger",dismissible:"",fade:"",show:e.showDangerAlert},on:{dismissed:function(t){e.showDangerAlert=!e.showDangerAlert}}},[e._v(e._s(e.alertMessage))]),s("b-alert",{attrs:{variant:"success",dismissible:"",fade:"",show:e.showSuccessAlert},on:{dismissed:function(t){e.showSuccessAlert=!e.showSuccessAlert}}},[e._v(e._s(e.alertMessage))])],1),s("div",{staticClass:"w-100 text-right",attrs:{slot:"modal-footer"},slot:"modal-footer"},[s("b-button",{attrs:{size:"md",variant:"danger"},on:{click:e.sendMessage}},[e._v("Отправить сообщение")]),s("b-button",{attrs:{size:"md"},on:{click:function(t){e.isSendMessageWindowShowing=!1}}},[e._v("Отмена")])],1)],1)],1)],1)},ae=[];function ne(e,t,s,a,n,r,i){try{var o=e[r](i),c=o.value}catch(l){return void s(l)}o.done?t(c):Promise.resolve(c).then(a,n)}function re(e){return function(){var t=this,s=arguments;return new Promise(function(a,n){var r=e.apply(t,s);function i(e){ne(r,a,n,i,o,"next",e)}function o(e){ne(r,a,n,i,o,"throw",e)}i(void 0)})}}var ie={data:[],message:"",isSuccessfully:!1},oe={getUsers:function(){var e=re(M.a.mark(function e(t,s){var n,r,i=arguments;return M.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(n=i.length>2&&void 0!==i[2]?i[2]:"/api/user/all?beginPage=",e.prev=1,t&&s){e.next=4;break}throw new Error("Couldn't load users because begin or end page not specified!");case 4:if(n){e.next=6;break}throw new Error("Could't get users data because url parameter not specified!");case 6:return n=n+t+"&endPage="+s,e.next=9,a["a"].axios.get(n);case 9:r=e.sent,r&&r.data?(ie.data=r.data?r.data:[],ie.message=r.data.message?r.data.message:"200. Данные успешно получены!",ie.isSuccessfully=!0):(ie.data=[],ie.message=r.data.message?r.data.message:"Данные не получены!",ie.isSuccessfully=!1),e.next=18;break;case 13:e.prev=13,e.t0=e["catch"](1),ie.data=[],Object({NODE_ENV:"production",VUE_APP_BASE_URL:"/",BASE_URL:"/"}).VUE_APP_IS_DEV?ie.message=JSON.stringify(e.t0):ie.message=e.t0.response.data?e.t0.response.data:"Данные не получены!",ie.isSuccessfully=!1;case 18:return e.abrupt("return",ie);case 19:case"end":return e.stop()}},e,this,[[1,13]])}));function t(t,s){return e.apply(this,arguments)}return t}(),sendMessageToUser:function(){var e=re(M.a.mark(function e(t,s){var n,r,i=arguments;return M.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(n=i.length>2&&void 0!==i[2]?i[2]:"/api/user/",e.prev=1,"string"===typeof t){e.next=4;break}throw new Error("Невозможно отправить пустое сообщение!");case 4:if("number"===typeof s){e.next=6;break}throw new Error("Couldn't send message, chatId is required!");case 6:return e.next=8,a["a"].axios.put(n+s,JSON.stringify(t));case 8:r=e.sent,ie.isSuccessfully=!0,ie.message="Сообщение успешно отправлено!",r&&r.data&&(ie.message=r.data.message?r.data.message:"Сообщение успешно отправлено!"),e.next=18;break;case 14:e.prev=14,e.t0=e["catch"](1),Object({NODE_ENV:"production",VUE_APP_BASE_URL:"/",BASE_URL:"/"}).VUE_APP_IS_DEV?ie.message=JSON.stringify(e.t0):ie.message=e.t0.response.data?e.t0.response.data:"Сообщение не отправлено!",ie.isSuccessfully=!1;case 18:return e.abrupt("return",ie);case 19:case"end":return e.stop()}},e,this,[[1,14]])}));function t(t,s){return e.apply(this,arguments)}return t}()},ce=function(){var e=this,t=e.$createElement,s=e._self._c||t;return e.isLoading?s("div",{staticClass:"loading"},[s("h4",[e._v(e._s(e.message))])]):e._e()},le=[],de={props:{isLoading:{type:Boolean,required:!0,default:!1},message:{type:String,required:!1,default:"Загрузка данных..."}}},ue=de,he=(s("9f48"),Object(h["a"])(ue,ce,le,!1,null,null,null)),ge=he.exports;function fe(e,t,s,a,n,r,i){try{var o=e[r](i),c=o.value}catch(l){return void s(l)}o.done?t(c):Promise.resolve(c).then(a,n)}function me(e){return function(){var t=this,s=arguments;return new Promise(function(a,n){var r=e.apply(t,s);function i(e){fe(r,a,n,i,o,"next",e)}function o(e){fe(r,a,n,i,o,"throw",e)}i(void 0)})}}var pe={components:{NavBar:W["default"],Loading:ge},created:function(){this.loadUsers(1,15)},data:function(){return{tableData:{fields:[{key:"chatId",label:"Id в ТГ",sortable:!0},{key:"nickName",label:"Ник",sortable:!0},{key:"firstAndLastName",label:"Имя и фамилия",sortable:!0},{key:"lastVisitDateTime",label:"Последняя дата визита",sortable:!0},{key:"msgCount",label:"Кол-во сообщений",sortable:!0},{key:"messageForUser",label:"Написать сообщение"}],items:[]},botUsersTotalCount:0,isLoading:!1,modalTitle:"Внимание!",modalText:"",isModalWindowShowing:!1,currentPage:1,dataRowsPerPage:15,isSendMessageWindowShowing:!1,selectedUser:{},messageForSend:"",showDangerAlert:!1,alertMessage:"",showSuccessAlert:!1}},methods:{loadUsers:function(){var e=me(M.a.mark(function e(){var t,s,a,n=arguments;return M.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t=n.length>0&&void 0!==n[0]?n[0]:1,s=n.length>1&&void 0!==n[1]?n[1]:15,e.prev=2,this.isLoading=!0,e.next=6,oe.getUsers(t,s);case 6:a=e.sent,a&&a.isSuccessfully?(this.tableData.items=a.data.botUsers,this.botUsersTotalCount=a.data.botUsersCount):(this.modalText=a.message,this.isModalWindowShowing=!0),e.next=15;break;case 10:e.prev=10,e.t0=e["catch"](2),this.modalText="Ошибка не удалось загрузить данные!",Object({NODE_ENV:"production",VUE_APP_BASE_URL:"/",BASE_URL:"/"}).VUE_APP_IS_DEV&&console.log(e.t0.toString()),this.isModalWindowShowing=!0;case 15:this.isLoading=!1;case 16:case"end":return e.stop()}},e,this,[[2,10]])}));function t(){return e.apply(this,arguments)}return t}(),sendMessage:function(){var e=me(M.a.mark(function e(){var t;return M.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(e.prev=0,this.selectedUser||this.selectedUser.chatId){e.next=3;break}throw new Error("Пользователь не выбран!");case 3:if(this.messageForSend){e.next=5;break}throw new Error("Сообщение для пользователя не может быть пустым!");case 5:return e.next=7,oe.sendMessageToUser(this.messageForSend,this.selectedUser.chatId);case 7:t=e.sent,t.isSuccessfully?(this.alertMessage=t.message?t.message:"Сообщение успешно отправлено!",this.showSuccessAlert=!0):(this.alertMessage=t.message?t.message:"Сообщение не отправлено!",this.showDangerAlert=!0),e.next=15;break;case 11:e.prev=11,e.t0=e["catch"](0),this.showDangerAlert=!0,this.alertMessage=e.t0.toString();case 15:case"end":return e.stop()}},e,this,[[0,11]])}));function t(){return e.apply(this,arguments)}return t}()},watch:{currentPage:function(e){var t=1;t=this.botUsersTotalCount<e*this.dataRowsPerPage?this.botUsersTotalCount:e*this.dataRowsPerPage;var s=t-this.dataRowsPerPage+1;this.loadUsers(s,t)},showDangerAlert:function(e){e&&(this.showSuccessAlert=!1)},showSuccessAlert:function(e){e&&(this.showDangerAlert=!1)},alertMessage:function(e){e||(this.showDangerAlert=!1,this.showSuccessAlert=!1)},isSendMessageWindowShowing:function(e){e||(this.selectedUser={},this.messageForSend="",this.alertMessage="")}}},we=pe,be=(s("e46e"),Object(h["a"])(we,se,ae,!1,null,null,null)),ve=be.exports,Se=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("nav-bar"),s("loading",{attrs:{isLoading:e.isLoading}}),e.isLoading?e._e():s("b-container",[s("b-row",{staticClass:"w-100 text-right create-action"},[s("b-col",[s("b-button",{attrs:{variant:"danger"},on:{click:e.createNewAction}},[e._v("Создать новую акцию")])],1)],1),s("b-table",{attrs:{"primary-key":"actionId",bordered:"",hover:"",fields:e.tableData.fields,items:e.tableData.items,"head-variant":"light",responsive:""},scopedSlots:e._u([{key:"state",fn:function(t){return[s("a",{attrs:{href:"#"}},[t.item.state?s("i",{staticClass:"material-icons done_all",on:{click:function(s){e.selectedAction=t.item,e.selectedAction.state=!1,e.saveAction()}}},[e._v("done_all")]):s("i",{staticClass:"material-icons done",on:{click:function(s){e.selectedAction=t.item,e.selectedAction.state=!0,e.saveAction()}}},[e._v("done")])])]}},{key:"moreInfo",fn:function(t){return[s("a",{staticClass:"material-icons search",attrs:{href:"#"},on:{click:function(s){e.selectedAction=t.item,e.isActionEditWindowShowing=!0}}},[e._v("search")])]}}])}),s("b-pagination",{staticStyle:{"margin-bottom":"5%"},attrs:{align:"center","total-rows":e.actionTotalCount,"per-page":e.dataRowsPerPage,limit:8},model:{value:e.currentPage,callback:function(t){e.currentPage=t},expression:"currentPage"}}),s("b-modal",{attrs:{title:e.modalTitle,centered:"","cancel-disabled":""},model:{value:e.isModalWindowShowing,callback:function(t){e.isModalWindowShowing=t},expression:"isModalWindowShowing"}},[s("p",[e._v(e._s(e.modalText))])]),s("b-modal",{attrs:{size:"lg",title:"Данные по акции "+e.selectedAction.nameOfAction,centered:""},model:{value:e.isActionEditWindowShowing,callback:function(t){e.isActionEditWindowShowing=t},expression:"isActionEditWindowShowing"}},[s("b-container",[s("b-form-group",{attrs:{label:"Название акции","label-cols-md":"4"}},[s("b-row",[s("b-col",[s("b-form-input",{attrs:{type:"text",required:""},model:{value:e.selectedAction.nameOfAction,callback:function(t){e.$set(e.selectedAction,"nameOfAction",t)},expression:"selectedAction.nameOfAction"}})],1)],1)],1),s("b-form-group",{attrs:{"label-cols-md":"4",label:"Команда в телеграме",description:"Должна начинаться с '/'' и содержать только цифры и английские буквы"}},[s("b-row",[s("b-col",[s("b-form-input",{attrs:{required:""},model:{value:e.selectedAction.commandText,callback:function(t){e.$set(e.selectedAction,"commandText",t)},expression:"selectedAction.commandText"}})],1)],1)],1),s("b-form-group",{attrs:{"label-cols-md":"4",label:"Описание акции"}},[s("b-row",[s("b-col",[s("b-form-textarea",{model:{value:e.selectedAction.advertisingText,callback:function(t){e.$set(e.selectedAction,"advertisingText",t)},expression:"selectedAction.advertisingText"}})],1)],1)],1),s("b-form-group",[s("b-row",[s("b-col",{attrs:{md:"3"}},[s("label",{attrs:{for:"beginDate"}},[e._v("Дата начала")])]),s("b-col",{attrs:{md:"3"}},[s("b-form-input",{attrs:{id:"beginDate",type:"date",required:"",value:e.selectedAction.formattedDateBegin}})],1),s("b-col",{attrs:{md:"3"}},[s("label",{attrs:{for:"endData"}},[e._v("Дата окончания")])]),s("b-col",{attrs:{md:"3"}},[s("b-form-input",{attrs:{id:"endData",type:"date",required:"",value:e.selectedAction.formattedDateEnd}})],1)],1)],1),s("b-alert",{attrs:{variant:"danger",dismissible:"",fade:"",show:e.showDangerAlert},on:{dismissed:function(t){e.showDangerAlert=!e.showDangerAlert}}},[e._v(e._s(e.alertMessage))]),s("b-alert",{attrs:{variant:"success",dismissible:"",fade:"",show:e.showSuccessAlert},on:{dismissed:function(t){e.showSuccessAlert=!e.showSuccessAlert}}},[e._v(e._s(e.alertMessage))])],1),s("div",{staticClass:"w-100 text-right",attrs:{slot:"modal-footer"},slot:"modal-footer"},[s("b-button",{attrs:{size:"md",variant:"danger"},on:{click:e.saveAction}},[e._v("Сохранить")]),s("b-button",{attrs:{size:"md"},on:{click:function(t){e.isActionEditWindowShowing=!1}}},[e._v("Отмена")])],1)],1)],1)],1)},Ae=[];function xe(e,t,s,a,n,r,i){try{var o=e[r](i),c=o.value}catch(l){return void s(l)}o.done?t(c):Promise.resolve(c).then(a,n)}function _e(e){return function(){var t=this,s=arguments;return new Promise(function(a,n){var r=e.apply(t,s);function i(e){xe(r,a,n,i,o,"next",e)}function o(e){xe(r,a,n,i,o,"throw",e)}i(void 0)})}}var ye={data:[],message:"",isSuccessfully:!1},ke={getActions:function(){var e=_e(M.a.mark(function e(t,s){var n,r,i=arguments;return M.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(n=i.length>2&&void 0!==i[2]?i[2]:"/api/advertising?beginPage=",e.prev=1,t&&s){e.next=4;break}throw new Error("Couldn't load actions because begin or end page not specified!");case 4:if(n){e.next=6;break}throw new Error("Could't get action data because url parameter not specified!");case 6:return n=n+t+"&endPage="+s,e.next=9,a["a"].axios.get(n);case 9:r=e.sent,r&&r.data?(ye.data=r.data?r.data:[],ye.message=r.data.message?r.data.message:"200. Данные успешно получены!",ye.isSuccessfully=!0):(ye.data=[],ye.message=r.data.message?r.data.message:"Данные не получены!",ye.isSuccessfully=!1),e.next=18;break;case 13:e.prev=13,e.t0=e["catch"](1),ye.data=[],Object({NODE_ENV:"production",VUE_APP_BASE_URL:"/",BASE_URL:"/"}).VUE_APP_IS_DEV?ye.message=JSON.stringify(e.t0):ye.message=e.t0.response.data?e.t0.response.data:"Данные не получены!",ye.isSuccessfully=!1;case 18:return e.abrupt("return",ye);case 19:case"end":return e.stop()}},e,this,[[1,13]])}));function t(t,s){return e.apply(this,arguments)}return t}(),saveNewAction:function(){var e=_e(M.a.mark(function e(t){var s,n,r=arguments;return M.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(s=r.length>1&&void 0!==r[1]?r[1]:"/api/advertising",e.prev=1,t){e.next=4;break}throw new Error("Couldn't save action! Action data is null or undefined!");case 4:if(s){e.next=6;break}throw new Error("Could't save action data because url parameter not specified!");case 6:return e.next=8,a["a"].axios.post(s,t);case 8:n=e.sent,ye.isSuccessfully=!0,ye.message="Данные успешно сохранены!",n&&n.data&&(ye.message=n.data.message?n.data.message:ye.message),e.next=18;break;case 14:e.prev=14,e.t0=e["catch"](1),Object({NODE_ENV:"production",VUE_APP_BASE_URL:"/",BASE_URL:"/"}).VUE_APP_IS_DEV?ye.message=JSON.stringify(e.t0):ye.message=e.t0.response.data?e.t0.response.data:"Данные не сохранены!",ye.isSuccessfully=!1;case 18:return e.abrupt("return",ye);case 19:case"end":return e.stop()}},e,this,[[1,14]])}));function t(t){return e.apply(this,arguments)}return t}(),updateAction:function(){var e=_e(M.a.mark(function e(t){var s,n,r=arguments;return M.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(s=r.length>1&&void 0!==r[1]?r[1]:"/api/advertising",e.prev=1,t){e.next=4;break}throw new Error("Couldn't save action! Action data is null or undefined!");case 4:if(s){e.next=6;break}throw new Error("Couldn't save action data because url parameter not specified!");case 6:n=a["a"].axios.put(s,t),ye.isSuccessfully=!0,ye.message="Данные успешно обновлены!",n&&n.data&&(ye.message=n.data.message?n.data.message:ye.message),e.next=16;break;case 12:e.prev=12,e.t0=e["catch"](1),Object({NODE_ENV:"production",VUE_APP_BASE_URL:"/",BASE_URL:"/"}).VUE_APP_IS_DEV?ye.message=JSON.stringify(e.t0):ye.message=e.t0.response.data?e.t0.response.data:"Данные не обновлены!",ye.isSuccessfully=!1;case 16:return e.abrupt("return",ye);case 17:case"end":return e.stop()}},e,this,[[1,12]])}));function t(t){return e.apply(this,arguments)}return t}()};function Ee(e,t,s,a,n,r,i){try{var o=e[r](i),c=o.value}catch(l){return void s(l)}o.done?t(c):Promise.resolve(c).then(a,n)}function Pe(e){return function(){var t=this,s=arguments;return new Promise(function(a,n){var r=e.apply(t,s);function i(e){Ee(r,a,n,i,o,"next",e)}function o(e){Ee(r,a,n,i,o,"throw",e)}i(void 0)})}}var De={components:{NavBar:W["default"],Loading:ge},created:function(){this.loadActions(1,15)},data:function(){return{tableData:{fields:[{key:"actionId",label:"Id акции",sortable:!0},{key:"nameOfAction",label:"Название акции",sortable:!0},{key:"advertisingTextShort",label:"Описание акции",sortable:!0},{key:"formattedDateBegin",label:"Дата начала акции",sortable:!0},{key:"formattedDateEnd",label:"Дата окончания акции",sortable:!0},{key:"state",label:"Активна/Не активна"},{key:"moreInfo",label:"Подробнее"}],items:[]},actionTotalCount:0,isLoading:!1,modalTitle:"Внимание!",modalText:"",isModalWindowShowing:!1,currentPage:1,dataRowsPerPage:15,isActionEditWindowShowing:!1,selectedAction:{},showDangerAlert:!1,alertMessage:"",showSuccessAlert:!1}},methods:{loadActions:function(){var e=Pe(M.a.mark(function e(){var t,s,a,n=arguments;return M.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t=n.length>0&&void 0!==n[0]?n[0]:1,s=n.length>1&&void 0!==n[1]?n[1]:15,e.prev=2,this.isLoading=!0,e.next=6,ke.getActions(t,s);case 6:a=e.sent,a&&a.isSuccessfully?(this.tableData.items=a.data.actions,this.actionTotalCount=a.data.totalCount):(this.modalText=a.message,this.isModalWindowShowing=!0),e.next=15;break;case 10:e.prev=10,e.t0=e["catch"](2),this.modalText="Ошибка не удалось загрузить данные!",Object({NODE_ENV:"production",VUE_APP_BASE_URL:"/",BASE_URL:"/"}).VUE_APP_IS_DEV&&console.log(e.t0.toString()),this.isModalWindowShowing=!0;case 15:this.isLoading=!1;case 16:case"end":return e.stop()}},e,this,[[2,10]])}));function t(){return e.apply(this,arguments)}return t}(),saveAction:function(){var e=Pe(M.a.mark(function e(){var t,s=this;return M.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(e.prev=0,this.selectedAction){e.next=3;break}throw new Error("Данные по акции пусты!");case 3:if(this.selectedAction.nameOfAction){e.next=5;break}throw new Error("Необходимо указать название акции!");case 5:if(this.selectedAction.advertisingText){e.next=7;break}throw new Error("Необходимо указать описание акции!");case 7:if(this.selectedAction.commandText&&this.selectedAction.commandText.match(/^\/[a-zA-Z_0-9]+/gm)){e.next=9;break}throw new Error('Заполните правильно поле "Команда в телеграме"');case 9:if(this.selectedAction.formattedDateBegin&&this.selectedAction.formattedDateEnd){e.next=11;break}throw new Error("Укажите дату начала и дату окончания акции!");case 11:if(t=null,!(this.selectedAction.actionId<=0)){e.next=18;break}return e.next=15,ke.saveNewAction(this.selectedAction);case 15:t=e.sent,e.next=21;break;case 18:return e.next=20,ke.updateAction(this.selectedAction);case 20:t=e.sent;case 21:t.isSuccessfully?(this.alertMessage=t.message?t.message:"Данные по акции успешно сохранены!",this.showSuccessAlert=!0,this.selectedAction<=0?setTimeout(function(){s.isActionEditWindowShowing=!1,s.loadActions(1,15)},3e3):setTimeout(function(){s.isActionEditWindowShowing=!1},3e3)):(this.alertMessage=t.message?t.message:"Данные не сохранены!",this.showDangerAlert=!0),e.next=28;break;case 24:e.prev=24,e.t0=e["catch"](0),this.showDangerAlert=!0,this.alertMessage=e.t0.toString();case 28:case"end":return e.stop()}},e,this,[[0,24]])}));function t(){return e.apply(this,arguments)}return t}(),createNewAction:function(){this.hideAlerts(),this.selectedAction={actionId:0,commandText:"/new_action_123",formattedDateBegin:"2020-01-01",formattedDateEnd:"",nameOfAction:"",advertisingText:""},this.selectedAction.actionId=0,this.selectedAction.commandText="",this.selectedAction.formattedDateBegin="2020-01-01",this.selectedAction.formattedDateEnd="2020-01-31",this.selectedAction.state=!0,this.isActionEditWindowShowing=!0},hideAlerts:function(){this.showDangerAlert=!1,this.showSuccessAlert=!1}},watch:{currentPage:function(e){var t=1;t=this.actionTotalCount<e*this.dataRowsPerPage?this.actionTotalCount:e*this.dataRowsPerPage;var s=t-this.dataRowsPerPage+1;this.loadUsers(s,t)},showDangerAlert:function(e){e&&(this.showSuccessAlert=!1)},showSuccessAlert:function(e){e&&(this.showDangerAlert=!1)},alertMessage:function(e){e||(this.showDangerAlert=!1,this.showSuccessAlert=!1)},isActionEditWindowShowing:function(e){e||(this.selectedAction={},this.alertMessage="")}}},Ie=De,Ce=(s("544a"),Object(h["a"])(Ie,Se,Ae,!1,null,null,null)),Ue=Ce.exports,Me=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("nav-bar"),s("loading",{attrs:{isLoading:e.isLoading}}),e.isLoading?e._e():s("b-container",[s("b-row",{staticClass:"w-100 text-right create-drugstore"},[s("b-col",[s("b-button",{attrs:{variant:"danger"},on:{click:e.createNewDrugStore}},[e._v("Создать новую аптеку")])],1)],1),s("b-table",{attrs:{"primary-key":"drugStoreId",bordered:"",hover:"",fields:e.tableData.fields,items:e.tableData.items,"head-variant":"light",responsive:""},scopedSlots:e._u([{key:"status",fn:function(t){return[s("a",{attrs:{href:"#"}},[t.item.status?s("i",{staticClass:"material-icons done_all",on:{click:function(s){e.selectedDrugStore=t.item,e.selectedDrugStore.status=!1,e.saveDrugStore()}}},[e._v("done_all")]):s("i",{staticClass:"material-icons done",on:{click:function(s){e.selectedDrugStore=t.item,e.selectedDrugStore.status=!0,e.saveDrugStore()}}},[e._v("done")])])]}},{key:"moreInfo",fn:function(t){return[s("a",{staticClass:"material-icons search",attrs:{href:"#"},on:{click:function(s){e.selectedDrugStore=t.item,e.isDrugStoreEditWindowShowing=!0}}},[e._v("search")])]}}])}),s("b-pagination",{staticStyle:{"margin-bottom":"5%"},attrs:{align:"center","total-rows":e.drugStoreTotalCount,"per-page":e.dataRowsPerPage,limit:8},model:{value:e.currentPage,callback:function(t){e.currentPage=t},expression:"currentPage"}}),s("b-modal",{attrs:{title:e.modalTitle,centered:"","cancel-disabled":""},model:{value:e.isModalWindowShowing,callback:function(t){e.isModalWindowShowing=t},expression:"isModalWindowShowing"}},[s("p",[e._v(e._s(e.modalText))])]),s("b-modal",{attrs:{size:"lg",title:"Данные по аптеке "+e.selectedDrugStore.drugStoreName,centered:""},model:{value:e.isDrugStoreEditWindowShowing,callback:function(t){e.isDrugStoreEditWindowShowing=t},expression:"isDrugStoreEditWindowShowing"}},[s("b-container",[s("b-form-group",{attrs:{label:'Id аптеки из "аналитики"',"label-cols-md":"4",description:"Необходим для синхронизации остатков"}},[s("b-row",[s("b-col",[s("b-form-input",{attrs:{type:"number",required:""},model:{value:e.selectedDrugStore.drugStoreId,callback:function(t){e.$set(e.selectedDrugStore,"drugStoreId",t)},expression:"selectedDrugStore.drugStoreId"}})],1)],1)],1),s("b-form-group",{attrs:{label:"Название аптеки","label-cols-md":"4"}},[s("b-row",[s("b-col",[s("b-form-input",{attrs:{type:"text",required:""},model:{value:e.selectedDrugStore.drugStoreName,callback:function(t){e.$set(e.selectedDrugStore,"drugStoreName",t)},expression:"selectedDrugStore.drugStoreName"}})],1)],1)],1),s("b-form-group",{attrs:{"label-cols-md":"4",label:"Ориентир"}},[s("b-row",[s("b-col",[s("b-form-input",{attrs:{type:"text"},model:{value:e.selectedDrugStore.orientir,callback:function(t){e.$set(e.selectedDrugStore,"orientir",t)},expression:"selectedDrugStore.orientir"}})],1)],1)],1),s("b-form-group",[s("b-row",[s("b-col",{attrs:{md:"6"}},[s("label",{attrs:{for:"drugstore-phone"}},[e._v("Телефон")]),s("b-form-input",{attrs:{id:"drugstore-phone",type:"text"},model:{value:e.selectedDrugStore.phone,callback:function(t){e.$set(e.selectedDrugStore,"phone",t)},expression:"selectedDrugStore.phone"}})],1),s("b-col",{attrs:{md:"6"}},[s("label",{attrs:{for:"work-time"}},[e._v("Режим работы")]),s("b-form-input",{attrs:{id:"work-time",type:"text"},model:{value:e.selectedDrugStore.workTime,callback:function(t){e.$set(e.selectedDrugStore,"workTime",t)},expression:"selectedDrugStore.workTime"}})],1)],1)],1),s("b-form-group",{attrs:{"label-cols-md":"4",label:"Адрес"}},[s("b-row",[s("b-col",[s("b-form-input",{attrs:{type:"text",required:""},model:{value:e.selectedDrugStore.address,callback:function(t){e.$set(e.selectedDrugStore,"address",t)},expression:"selectedDrugStore.address"}})],1)],1)],1),s("b-form-group",{attrs:{"label-cols-md":"12",label:"Город/Район"}},[s("b-row",[s("b-col",[s("b-dropdown",{staticClass:"w-50",attrs:{dropright:"",variant:"outline-secondary"}},[s("template",{slot:"button-content"},[e._v("\r\n                                       "+e._s(e.selectedDrugStore.district)+"\r\n                                ")]),e._l(e.districts,function(t,a){return s("b-dropdown-item",{key:a,attrs:{href:"#"},on:{click:function(s){e.selectedDrugStore.district=t}}},[e._v(e._s(t))])})],2)],1)],1)],1),s("b-alert",{attrs:{variant:"danger",dismissible:"",fade:"",show:e.showDangerAlert},on:{dismissed:function(t){e.showDangerAlert=!e.showDangerAlert}}},[e._v(e._s(e.alertMessage))]),s("b-alert",{attrs:{variant:"success",dismissible:"",fade:"",show:e.showSuccessAlert},on:{dismissed:function(t){e.showSuccessAlert=!e.showSuccessAlert}}},[e._v(e._s(e.alertMessage))])],1),s("div",{staticClass:"w-100 text-right",attrs:{slot:"modal-footer"},slot:"modal-footer"},[s("b-button",{attrs:{size:"md",variant:"danger"},on:{click:e.saveDrugStore}},[e._v("Сохранить")]),s("b-button",{attrs:{size:"md"},on:{click:function(t){e.isDrugStoreEditWindowShowing=!1}}},[e._v("Отмена")])],1)],1)],1)],1)},We=[];function Te(e,t,s,a,n,r,i){try{var o=e[r](i),c=o.value}catch(l){return void s(l)}o.done?t(c):Promise.resolve(c).then(a,n)}function Ne(e){return function(){var t=this,s=arguments;return new Promise(function(a,n){var r=e.apply(t,s);function i(e){Te(r,a,n,i,o,"next",e)}function o(e){Te(r,a,n,i,o,"throw",e)}i(void 0)})}}var Le={data:[],message:"",isSuccessfully:!1},Oe={getDrugStores:function(){var e=Ne(M.a.mark(function e(t,s){var n,r,i=arguments;return M.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(n=i.length>2&&void 0!==i[2]?i[2]:"/api/drugstore?beginPage=",e.prev=1,t&&s){e.next=4;break}throw new Error("Couldn't load drugStores because begin or end page not specified!");case 4:if(n){e.next=6;break}throw new Error("Could't get drugStores data because url parameter not specified!");case 6:return n=n+t+"&endPage="+s,e.next=9,a["a"].axios.get(n);case 9:r=e.sent,r&&r.data?(Le.data=r.data?r.data:[],Le.message=r.data.message?r.data.message:"200. Данные успешно получены!",Le.isSuccessfully=!0):(Le.data=[],Le.message=r.data.message?r.data.message:"Данные не получены!",Le.isSuccessfully=!1),e.next=18;break;case 13:e.prev=13,e.t0=e["catch"](1),Le.data=[],Object({NODE_ENV:"production",VUE_APP_BASE_URL:"/",BASE_URL:"/"}).VUE_APP_IS_DEV?Le.message=JSON.stringify(e.t0):Le.message=e.t0.response.data?e.t0.response.data:"Данные не получены!",Le.isSuccessfully=!1;case 18:return e.abrupt("return",Le);case 19:case"end":return e.stop()}},e,this,[[1,13]])}));function t(t,s){return e.apply(this,arguments)}return t}(),saveDrugStore:function(){var e=Ne(M.a.mark(function e(t){var s,n,r=arguments;return M.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(s=r.length>1&&void 0!==r[1]?r[1]:"/api/drugstore",e.prev=1,t){e.next=4;break}throw new Error("Couldn't save action! Action data is null or undefined!");case 4:if(s){e.next=6;break}throw new Error("Could't save action data because url parameter not specified!");case 6:return e.next=8,a["a"].axios.post(s,t);case 8:n=e.sent,Le.isSuccessfully=!0,Le.message="Данные успешно сохранены!",n&&n.data&&(Le.message=n.data.message?n.data.message:Le.message),e.next=18;break;case 14:e.prev=14,e.t0=e["catch"](1),Object({NODE_ENV:"production",VUE_APP_BASE_URL:"/",BASE_URL:"/"}).VUE_APP_IS_DEV?Le.message=JSON.stringify(e.t0):Le.message=e.t0.response.data?e.t0.response.data:"Данные не сохранены!",Le.isSuccessfully=!1;case 18:return e.abrupt("return",Le);case 19:case"end":return e.stop()}},e,this,[[1,14]])}));function t(t){return e.apply(this,arguments)}return t}(),getDistricts:function(){var e=Ne(M.a.mark(function e(){var t,s,n=arguments;return M.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(t=n.length>0&&void 0!==n[0]?n[0]:"/api/district",e.prev=1,t){e.next=4;break}throw new Error("Could't get users data because url parameter not specified!");case 4:return e.next=6,a["a"].axios.get(t);case 6:s=e.sent,s&&s.data?(Le.data=s.data?s.data:[],Le.message=s.data.message?s.data.message:"200. Данные успешно получены!",Le.isSuccessfully=!0):(Le.data=[],Le.message=s.data.message?s.data.message:"Данные не получены!",Le.isSuccessfully=!1),e.next=15;break;case 10:e.prev=10,e.t0=e["catch"](1),Le.data=[],Object({NODE_ENV:"production",VUE_APP_BASE_URL:"/",BASE_URL:"/"}).VUE_APP_IS_DEV?Le.message=JSON.stringify(e.t0):Le.message=e.t0.response.data?e.t0.response.data:"Данные не получены!",Le.isSuccessfully=!1;case 15:return e.abrupt("return",Le);case 16:case"end":return e.stop()}},e,this,[[1,10]])}));function t(){return e.apply(this,arguments)}return t}()};function Re(e,t,s,a,n,r,i){try{var o=e[r](i),c=o.value}catch(l){return void s(l)}o.done?t(c):Promise.resolve(c).then(a,n)}function Ve(e){return function(){var t=this,s=arguments;return new Promise(function(a,n){var r=e.apply(t,s);function i(e){Re(r,a,n,i,o,"next",e)}function o(e){Re(r,a,n,i,o,"throw",e)}i(void 0)})}}var Be="OK",Fe={components:{NavBar:W["default"],Loading:ge},created:function(){this.loadDrugStores(1,15),this.loadDistricts()},data:function(){return{tableData:{fields:[{key:"drugStoreId",label:"Id аптеки",sortable:!0},{key:"drugStoreName",label:"Название аптеки",sortable:!0},{key:"address",label:"Адрес аптеки",sortable:!0},{key:"phone",label:"Телефон",sortable:!0},{key:"district",label:"Район / Город",sortable:!0},{key:"status",label:"Открыта / Закрыта",sortable:!0},{key:"moreInfo",label:"Подробнее"}],items:[]},drugStoreTotalCount:0,isLoading:!1,modalTitle:"Внимание!",modalText:"",isModalWindowShowing:!1,currentPage:1,dataRowsPerPage:15,isDrugStoreEditWindowShowing:!1,selectedDrugStore:{},showDangerAlert:!1,alertMessage:"",showSuccessAlert:!1,districts:[]}},methods:{validateFields:function(e){var t="OK";try{e||(t="Что то пошло не так! Не удалось определить объект аптеки!"),e.drugStoreId&&0!==e.drugStoreId||(t='Укажите id аптеки из "Аналитики", оно нужно для синхронизации остатков товара!'),e.drugStoreName&&e.drugStoreName.match(/^Аптека №\d+|^Аптека№\d+|Аптека №\s\d+|^Аптека №\d+\W\d+/gm)||(t='Укажите правильное название аптеки оно должно начинаться на слово "Аптека" и содержать номер аптеки! К примеру "Аптека №1"'),e.address&&e.address.trim()||(t="Укажите адрес аптеки!"),e.workTime&&e.workTime.trim()||(t="Укажите режим работы аптеки!"),e.phone&&e.phone.trim()||(t="Укажите телефон аптеки!"),e.orientir&&e.orientir.trim()||(t="Укажите ориентир аптеки!"),(!e.district||!e.district.trim()||this.districts.indexOf(e.district)<0)&&(t="Выберите район из списка!")}catch(s){t="Не удалось проверить соответствие заполненных Вами данных!"}return t},loadDrugStores:function(){var e=Ve(M.a.mark(function e(){var t,s,a,n=arguments;return M.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t=n.length>0&&void 0!==n[0]?n[0]:1,s=n.length>1&&void 0!==n[1]?n[1]:15,e.prev=2,this.isLoading=!0,e.next=6,Oe.getDrugStores(t,s);case 6:a=e.sent,a&&a.isSuccessfully?(this.tableData.items=a.data.drugStores,this.drugStoreTotalCount=a.data.totalCount):(this.modalText=a.message,this.isModalWindowShowing=!0),e.next=15;break;case 10:e.prev=10,e.t0=e["catch"](2),this.modalText="Ошибка не удалось загрузить данные по аптекам!",Object({NODE_ENV:"production",VUE_APP_BASE_URL:"/",BASE_URL:"/"}).VUE_APP_IS_DEV&&console.log(e.t0.toString()),this.isModalWindowShowing=!0;case 15:this.isLoading=!1;case 16:case"end":return e.stop()}},e,this,[[2,10]])}));function t(){return e.apply(this,arguments)}return t}(),loadDistricts:function(){var e=Ve(M.a.mark(function e(){var t;return M.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,this.isLoading=!0,e.next=4,Oe.getDistricts();case 4:t=e.sent,t&&t.isSuccessfully?this.districts=t.data.districts:(this.modalText=t.message,this.isModalWindowShowing=!0),e.next=13;break;case 8:e.prev=8,e.t0=e["catch"](0),this.modalText="Ошибка не удалось загрузить данные по районам!",Object({NODE_ENV:"production",VUE_APP_BASE_URL:"/",BASE_URL:"/"}).VUE_APP_IS_DEV&&console.log(e.t0.toString()),this.isModalWindowShowing=!0;case 13:this.isLoading=!1;case 14:case"end":return e.stop()}},e,this,[[0,8]])}));function t(){return e.apply(this,arguments)}return t}(),saveDrugStore:function(){var e=Ve(M.a.mark(function e(){var t,s=this;return M.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(e.prev=0,this.validateFields(this.selectedDrugStore)!==Be){e.next=11;break}return this.alertMessage="",this.selectedDrugStore.shortName=this.selectedDrugStore.drugStoreName.match(/^Аптека №\d+|^Аптека№\d+|Аптека №\s\d+|^Аптека №\d+\W\d+/gm)[0],this.selectedDrugStore.drugStoreTotalCount=void 0,e.next=7,Oe.saveDrugStore(this.selectedDrugStore);case 7:t=e.sent,t.isSuccessfully?(this.alertMessage=t.message?t.message:"Данные по акции успешно сохранены!",this.showSuccessAlert=!0,this.selectedDrugStore.id<=0?setTimeout(function(){s.isDrugStoreEditWindowShowing=!1,s.loadDrugStores(1,15)},3e3):setTimeout(function(){s.isDrugStoreEditWindowShowing=!1},3e3)):(this.alertMessage=t.message?t.message:"Данные не сохранены!",this.showDangerAlert=!0),e.next=13;break;case 11:this.alertMessage=this.validateFields(this.selectedDrugStore),this.showDangerAlert=!0;case 13:e.next=19;break;case 15:e.prev=15,e.t0=e["catch"](0),this.showDangerAlert=!0,this.alertMessage=e.t0.toString();case 19:case"end":return e.stop()}},e,this,[[0,15]])}));function t(){return e.apply(this,arguments)}return t}(),createNewDrugStore:function(){this.hideAlerts(),this.selectedDrugStore={id:0,drugStoreId:0,drugStoreName:"",address:"",phone:"",workTime:"07:00-24:00",district:"г. Ташкент Мирабадский район",shortName:"",status:!0,orientir:""},this.isDrugStoreEditWindowShowing=!0},hideAlerts:function(){this.alertMessage=""}},watch:{currentPage:function(e){var t=1;t=this.drugStoreTotalCount<e*this.dataRowsPerPage?this.drugStoreTotalCount:e*this.dataRowsPerPage;var s=t-this.dataRowsPerPage+1;this.loadDrugStores(s,t)},showDangerAlert:function(e){e&&(this.showSuccessAlert=!1)},showSuccessAlert:function(e){e&&(this.showDangerAlert=!1)},alertMessage:function(e){e||(this.showDangerAlert=!1,this.showSuccessAlert=!1)},isDrugStoreEditWindowShowing:function(e){e||(this.selectedDrugStore={},this.alertMessage="",this.showDangerAlert=!1,this.showSuccessAlert=!1)}}},je=Fe,qe=(s("326b"),Object(h["a"])(je,Me,We,!1,null,null,null)),$e=qe.exports,ze=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("nav-bar"),s("loading",{attrs:{isLoading:e.isLoading}}),e.isLoading?e._e():s("b-container",[s("b-table",{attrs:{"primary-key":"requestId",bordered:"",hover:"",fields:e.tableData.fields,items:e.tableData.items,"head-variant":"light",responsive:"","caption-top":""}},[s("template",{slot:"table-caption"},[s("strong",{staticClass:"text-danger"},[e._v("Кол-во запросов сегодня: "+e._s(e.todayRequestsCount))])])],2),s("b-pagination",{staticStyle:{"margin-bottom":"5%"},attrs:{align:"center","total-rows":e.requestsTotalCount,"per-page":e.dataRowsPerPage,limit:8},model:{value:e.currentPage,callback:function(t){e.currentPage=t},expression:"currentPage"}}),s("b-modal",{attrs:{title:e.modalTitle,centered:"","cancel-disabled":""},model:{value:e.isModalWindowShowing,callback:function(t){e.isModalWindowShowing=t},expression:"isModalWindowShowing"}},[s("p",[e._v(e._s(e.modalText))])])],1)],1)},Je=[];function Qe(e,t,s,a,n,r,i){try{var o=e[r](i),c=o.value}catch(l){return void s(l)}o.done?t(c):Promise.resolve(c).then(a,n)}function Ge(e){return function(){var t=this,s=arguments;return new Promise(function(a,n){var r=e.apply(t,s);function i(e){Qe(r,a,n,i,o,"next",e)}function o(e){Qe(r,a,n,i,o,"throw",e)}i(void 0)})}}var Ye={data:[],message:"",isSuccessfully:!1},He={getRequests:function(){var e=Ge(M.a.mark(function e(t,s){var n,r,i=arguments;return M.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(n=i.length>2&&void 0!==i[2]?i[2]:"/api/request?beginPage=",e.prev=1,t&&s){e.next=4;break}throw new Error("Couldn't load users because begin or end page not specified!");case 4:if(n){e.next=6;break}throw new Error("Could't get users data because url parameter not specified!");case 6:return n=n+t+"&endPage="+s,e.next=9,a["a"].axios.get(n);case 9:r=e.sent,r&&r.data?(Ye.data=r.data?r.data:[],Ye.message=r.data.message?r.data.message:"200. Данные успешно получены!",Ye.isSuccessfully=!0):(Ye.data=[],Ye.message=r.data.message?r.data.message:"Данные не получены!",Ye.isSuccessfully=!1),e.next=18;break;case 13:e.prev=13,e.t0=e["catch"](1),Ye.data=[],Object({NODE_ENV:"production",VUE_APP_BASE_URL:"/",BASE_URL:"/"}).VUE_APP_IS_DEV?Ye.message=JSON.stringify(e.t0):Ye.message=e.t0.response.data?e.t0.response.data:"Данные не получены!",Ye.isSuccessfully=!1;case 18:return e.abrupt("return",Ye);case 19:case"end":return e.stop()}},e,this,[[1,13]])}));function t(t,s){return e.apply(this,arguments)}return t}()};function Ke(e,t,s,a,n,r,i){try{var o=e[r](i),c=o.value}catch(l){return void s(l)}o.done?t(c):Promise.resolve(c).then(a,n)}function Xe(e){return function(){var t=this,s=arguments;return new Promise(function(a,n){var r=e.apply(t,s);function i(e){Ke(r,a,n,i,o,"next",e)}function o(e){Ke(r,a,n,i,o,"throw",e)}i(void 0)})}}var Ze={components:{NavBar:W["default"],Loading:ge},created:function(){this.loadRequests(1,15)},data:function(){return{tableData:{fields:[{key:"requestId",label:"Id запроса",sortable:!0},{key:"requestDateTime",label:"Дата и время запроса",sortable:!0},{key:"chatId",label:"Id пользователя в ТГ.",sortable:!0},{key:"userName",label:"Ник пользователя",sortable:!0},{key:"userFirstAndLastName",label:"Имя пользователя",sortable:!0},{key:"requestText",label:"Текст запроса"}],items:[]},requestsTotalCount:0,todayRequestsCount:0,isLoading:!1,modalTitle:"Внимание!",modalText:"",isModalWindowShowing:!1,currentPage:1,dataRowsPerPage:15,selectedRequest:{},showDangerAlert:!1,alertMessage:"",showSuccessAlert:!1,requests:[],selectedAcion:null}},methods:{loadRequests:function(){var e=Xe(M.a.mark(function e(){var t,s,a,n=arguments;return M.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t=n.length>0&&void 0!==n[0]?n[0]:1,s=n.length>1&&void 0!==n[1]?n[1]:15,e.prev=2,this.isLoading=!0,e.next=6,He.getRequests(t,s);case 6:a=e.sent,a&&a.isSuccessfully?(this.tableData.items=a.data.requests,this.requestsTotalCount=a.data.requestTotalCount,this.todayRequestsCount=a.data.todayRequestsCount):(this.modalText=a.message,this.isModalWindowShowing=!0),e.next=15;break;case 10:e.prev=10,e.t0=e["catch"](2),this.modalText="Ошибка не удалось загрузить данные!",Object({NODE_ENV:"production",VUE_APP_BASE_URL:"/",BASE_URL:"/"}).VUE_APP_IS_DEV&&console.log(e.t0.toString()),this.isModalWindowShowing=!0;case 15:this.isLoading=!1;case 16:case"end":return e.stop()}},e,this,[[2,10]])}));function t(){return e.apply(this,arguments)}return t}(),hideAlerts:function(){this.showDangerAlert=!1,this.showSuccessAlert=!1}},watch:{currentPage:function(e){var t=1;t=this.requestsTotalCount<e*this.dataRowsPerPage?this.requestsTotalCount:e*this.dataRowsPerPage;var s=t-this.dataRowsPerPage+1;this.loadRequests(s,t)},showDangerAlert:function(e){e&&(this.showSuccessAlert=!1)},showSuccessAlert:function(e){e&&(this.showDangerAlert=!1)},alertMessage:function(e){e||(this.showDangerAlert=!1,this.showSuccessAlert=!1)}}},et=Ze,tt=(s("6299"),Object(h["a"])(et,ze,Je,!1,null,null,null)),st=tt.exports,at=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("nav-bar"),s("loading",{attrs:{isLoading:e.isLoading}}),e.isLoading?e._e():s("b-container",[s("b-row",{staticClass:"w-100 text-right create-action"},[s("b-col",{staticClass:"text-left text-secondary"},[e._v("\r\n                Кол-во товаров с аннотацией: "+e._s(e.annotationsTotalCount)),s("br"),e._v("\r\n                Кол-во товаров с изображением: "+e._s(e.goodsCountWithImages)),s("br"),e._v("\r\n                Кол-во товаров без изображений: "+e._s(e.goodsCountWithoutImages)+"\r\n            ")]),s("b-col",[s("router-link",{attrs:{to:"/api/annotation/create"}},[s("b-button",{attrs:{variant:"danger"}},[e._v("Создать аннотацию")])],1)],1)],1),s("b-table",{staticClass:"w-100",attrs:{"primary-key":"annotationId",bordered:"",hover:"",fields:e.tableData.fields,items:e.tableData.items,"head-variant":"light",responsive:""},scopedSlots:e._u([{key:"usingWay",fn:function(t){return[s("a",{attrs:{href:"#"},on:{click:function(s){e.selectedAnnotation=t.item,e.editAnnotation(t.item,"usingWay")}}},[t.item.usingWay?s("i",{staticClass:"material-icons done_all"},[e._v("done_all")]):s("i",{staticClass:"material-icons done"},[e._v("done")])])]}},{key:"forWhatIsUse",fn:function(t){return[s("a",{attrs:{href:"#"},on:{click:function(s){e.selectedAnnotation=t.item,e.editAnnotation(t.item,"forWhatIsUse")}}},[t.item.forWhatIsUse?s("i",{staticClass:"material-icons done_all"},[e._v("done_all")]):s("i",{staticClass:"material-icons done"},[e._v("done")])])]}},{key:"specialInstructions",fn:function(t){return[s("a",{attrs:{href:"#"},on:{click:function(s){e.selectedAnnotation=t.item,e.editAnnotation(t.item,"specialInstructions")}}},[t.item.specialInstructions?s("i",{staticClass:"material-icons done_all"},[e._v("done_all")]):s("i",{staticClass:"material-icons done"},[e._v("done")])])]}},{key:"сontraIndicators",fn:function(t){return[s("a",{attrs:{href:"#"},on:{click:function(s){e.selectedAnnotation=t.item,e.editAnnotation(t.item,"сontraIndicators")}}},[t.item.сontraIndicators?s("i",{staticClass:"material-icons done_all"},[e._v("done_all")]):s("i",{staticClass:"material-icons done"},[e._v("done")])])]}},{key:"sideEffects",fn:function(t){return[s("a",{attrs:{href:"#"},on:{click:function(s){e.selectedAnnotation=t.item,e.editAnnotation(t.item,"sideEffects")}}},[t.item.sideEffects?s("i",{staticClass:"material-icons done_all"},[e._v("done_all")]):s("i",{staticClass:"material-icons done"},[e._v("done")])])]}},{key:"isImageExists",fn:function(t){return[s("a",{attrs:{href:"#"},on:{click:function(s){e.selectedAnnotation=t.item,e.chooseImg()}}},[t.item.isImageExists?s("i",{staticClass:"material-icons done_all"},[e._v("done_all")]):s("i",{staticClass:"material-icons done"},[e._v("done")])])]}}])}),s("b-pagination",{staticStyle:{"margin-bottom":"5%"},attrs:{align:"center","total-rows":e.annotationsTotalCount,"per-page":e.dataRowsPerPage,limit:8},model:{value:e.currentPage,callback:function(t){e.currentPage=t},expression:"currentPage"}}),s("b-modal",{attrs:{size:"lg",centered:""},model:{value:e.isAnnotationEditWindowShowing,callback:function(t){e.isAnnotationEditWindowShowing=t},expression:"isAnnotationEditWindowShowing"}},[s("template",{slot:"modal-title"},[s("p",{staticClass:"text-left",staticStyle:{"margin-left":"5pt"}},[s("strong",[e._v("Товар:")]),e._v(" "+e._s(e.selectedAnnotation.drugName)),s("br"),s("strong",[e._v("Производитель:")]),e._v(" "+e._s(e.selectedAnnotation.producer)+"\r\n                ")])]),s("b-container",[s("b-form-group",{attrs:{label:e.editAnnotationPropertyText,"label-cols-md":"4"}},[s("b-row",[s("b-col",[s("b-form-textarea",{attrs:{rows:7,"max-rows":7},model:{value:e.textForEdit,callback:function(t){e.textForEdit=t},expression:"textForEdit"}})],1)],1)],1),s("b-alert",{attrs:{variant:"danger",dismissible:"",fade:"",show:e.showDangerAlert},on:{dismissed:function(t){e.showDangerAlert=!e.showDangerAlert}}},[e._v(e._s(e.alertMessage))]),s("b-alert",{attrs:{variant:"success",dismissible:"",fade:"",show:e.showSuccessAlert},on:{dismissed:function(t){e.showSuccessAlert=!e.showSuccessAlert}}},[e._v(e._s(e.alertMessage))])],1),s("div",{staticClass:"w-100 text-right",attrs:{slot:"modal-footer"},slot:"modal-footer"},[s("b-button",{attrs:{size:"md",variant:"danger"},on:{click:e.updateAnnotation}},[e._v("Сохранить")]),s("b-button",{attrs:{size:"md"},on:{click:function(t){e.isAnnotationEditWindowShowing=!1}}},[e._v("Отмена")])],1)],2),s("b-modal",{attrs:{title:e.modalTitle,centered:"","cancel-disabled":""},model:{value:e.isModalWindowShowing,callback:function(t){e.isModalWindowShowing=t},expression:"isModalWindowShowing"}},[s("p",[e._v(e._s(e.modalText))])]),s("input",{ref:"input_img",staticStyle:{display:"none"},attrs:{type:"file"},on:{change:e.imageSelected}})],1)],1)},nt=[];function rt(e,t,s,a,n,r,i){try{var o=e[r](i),c=o.value}catch(l){return void s(l)}o.done?t(c):Promise.resolve(c).then(a,n)}function it(e){return function(){var t=this,s=arguments;return new Promise(function(a,n){var r=e.apply(t,s);function i(e){rt(r,a,n,i,o,"next",e)}function o(e){rt(r,a,n,i,o,"throw",e)}i(void 0)})}}var ot={data:[],message:"",isSuccessfully:!1},ct={getAnnotations:function(){var e=it(M.a.mark(function e(t,s){var n,r,i=arguments;return M.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(n=i.length>2&&void 0!==i[2]?i[2]:"/api/annotation?beginPage=",e.prev=1,t&&s){e.next=4;break}throw new Error("Couldn't load users because begin or end page not specified!");case 4:if(n){e.next=6;break}throw new Error("Could't get users data because url parameter not specified!");case 6:return n=n+t+"&endPage="+s,e.next=9,a["a"].axios.get(n);case 9:r=e.sent,r&&r.data?(ot.data=r.data?r.data:[],ot.message=r.data.message?r.data.message:"200. Данные успешно получены!",ot.isSuccessfully=!0):(ot.data=[],ot.message=r.data.message?r.data.message:"Данные не получены!",ot.isSuccessfully=!1),e.next=18;break;case 13:e.prev=13,e.t0=e["catch"](1),ot.data=[],Object({NODE_ENV:"production",VUE_APP_BASE_URL:"/",BASE_URL:"/"}).VUE_APP_IS_DEV?ot.message=JSON.stringify(e.t0):ot.message=e.t0.response.data?e.t0.response.data:"Данные не получены!",ot.isSuccessfully=!1;case 18:return e.abrupt("return",ot);case 19:case"end":return e.stop()}},e,this,[[1,13]])}));function t(t,s){return e.apply(this,arguments)}return t}(),getCertainAnnotation:function(){var e=it(M.a.mark(function e(t){var s,n,r=arguments;return M.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(s=r.length>1&&void 0!==r[1]?r[1]:"/api/annotation/",e.prev=1,t){e.next=4;break}throw new Error("Couldn't load certain annotation because annotationId input param is not specified!");case 4:if(s){e.next=6;break}throw new Error("Could't get certain annotation data because url parameter is not specified!");case 6:return s+=t,e.next=9,a["a"].axios.get(s);case 9:n=e.sent,n&&n.data?(ot.data=n.data?n.data:{},ot.message=n.data.message?n.data.message:"200. Данные успешно получены!",ot.isSuccessfully=!0):(ot.data={},ot.message=n.data.message?n.data.message:"Данные не получены!",ot.isSuccessfully=!1),e.next=18;break;case 13:e.prev=13,e.t0=e["catch"](1),ot.data=[],Object({NODE_ENV:"production",VUE_APP_BASE_URL:"/",BASE_URL:"/"}).VUE_APP_IS_DEV?ot.message=JSON.stringify(e.t0):ot.message=e.t0.response.data?e.t0.response.data:"Данные не получены!",ot.isSuccessfully=!1;case 18:return e.abrupt("return",ot);case 19:case"end":return e.stop()}},e,this,[[1,13]])}));function t(t){return e.apply(this,arguments)}return t}(),saveNewAnnotation:function(){var e=it(M.a.mark(function e(t){var s,n,r=arguments;return M.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(s=r.length>1&&void 0!==r[1]?r[1]:"/api/annotation",e.prev=1,t){e.next=4;break}throw new Error("Couldn't save annotation! Annotation data is null or undefined!");case 4:if(s){e.next=6;break}throw new Error("Could't save annotation data because url parameter not specified!");case 6:return e.next=8,a["a"].axios.post(s,t,{headers:{"Content-Type":"multipart/form-data"}});case 8:n=e.sent,ot.isSuccessfully=!0,ot.message="Данные успешно сохранены!",n&&n.data&&(ot.message=n.data.message?n.data.message:ot.message),e.next=18;break;case 14:e.prev=14,e.t0=e["catch"](1),Object({NODE_ENV:"production",VUE_APP_BASE_URL:"/",BASE_URL:"/"}).VUE_APP_IS_DEV?ot.message=JSON.stringify(e.t0):ot.message=e.t0.response.data?e.t0.response.data:"Данные не сохранены!",ot.isSuccessfully=!1;case 18:return e.abrupt("return",ot);case 19:case"end":return e.stop()}},e,this,[[1,14]])}));function t(t){return e.apply(this,arguments)}return t}(),updateAnnotation:function(){var e=it(M.a.mark(function e(t){var s,n,r=arguments;return M.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(s=r.length>1&&void 0!==r[1]?r[1]:"/api/annotation",e.prev=1,t){e.next=4;break}throw new Error("Couldn't save annotation! Annotation data is null or undefined!");case 4:if(s){e.next=6;break}throw new Error("Couldn't save annotation data because url parameter not specified!");case 6:n=a["a"].axios.put(s,t),ot.isSuccessfully=!0,ot.message="Данные успешно обновлены!",n&&n.data&&(ot.message=n.data.message?n.data.message:ot.message),e.next=16;break;case 12:e.prev=12,e.t0=e["catch"](1),Object({NODE_ENV:"production",VUE_APP_BASE_URL:"/",BASE_URL:"/"}).VUE_APP_IS_DEV?ot.message=JSON.stringify(e.t0):ot.message=e.t0.response.data?e.t0.response.data:"Данные не обновлены!",ot.isSuccessfully=!1;case 16:return e.abrupt("return",ot);case 17:case"end":return e.stop()}},e,this,[[1,12]])}));function t(t){return e.apply(this,arguments)}return t}(),saveImage:function(){var e=it(M.a.mark(function e(t){var s,n,r=arguments;return M.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(s=r.length>1&&void 0!==r[1]?r[1]:"/api/annotation/image",e.prev=1,t){e.next=4;break}throw new Error("Couldn't save annotation image! Annotation image data is null or undefined!");case 4:if(s){e.next=6;break}throw new Error("Could't save annotation image because url parameter not specified!");case 6:return e.next=8,a["a"].axios.post(s,t);case 8:n=e.sent,ot.isSuccessfully=!0,ot.message="Изображение успешно сохранено!",n&&n.data&&(ot.message=n.data.message?n.data.message:ot.message),e.next=18;break;case 14:e.prev=14,e.t0=e["catch"](1),Object({NODE_ENV:"production",VUE_APP_BASE_URL:"/",BASE_URL:"/"}).VUE_APP_IS_DEV?ot.message=JSON.stringify(e.t0):ot.message=e.t0.response.data?e.t0.response.data:"Данные не сохранены!",ot.isSuccessfully=!1;case 18:return e.abrupt("return",ot);case 19:case"end":return e.stop()}},e,this,[[1,14]])}));function t(t){return e.apply(this,arguments)}return t}()};function lt(e,t,s,a,n,r,i){try{var o=e[r](i),c=o.value}catch(l){return void s(l)}o.done?t(c):Promise.resolve(c).then(a,n)}function dt(e){return function(){var t=this,s=arguments;return new Promise(function(a,n){var r=e.apply(t,s);function i(e){lt(r,a,n,i,o,"next",e)}function o(e){lt(r,a,n,i,o,"throw",e)}i(void 0)})}}var ut={components:{NavBar:W["default"],Loading:ge},created:function(){this.loadAnnotations(1,15)},data:function(){return{tableData:{fields:[{key:"annotationId",label:"Id аннотации",sortable:!0},{key:"drugName",label:"Название товара",sortable:!0},{key:"producer",label:"Производитель",sortable:!0},{key:"usingWay",label:"Способ применения"},{key:"forWhatIsUse",label:"Предназначение"},{key:"specialInstructions",label:"Спец. указания"},{key:"сontraIndicators",label:"Противопоказания"},{key:"isImageExists",label:"Есть изображение"}],items:[]},selectedAnnotation:{},isAnnotationEditWindowShowing:!1,annotationModalHeader:"",messageFromServer:"",isLoading:!0,currentPage:1,dataRowsPerPage:15,annotationsTotalCount:0,goodsCountWithImages:0,goodsCountWithoutImages:0,showAlert:!1,textForEdit:"",editAnnotationPropertyText:"",editProperty:"",selectedImg:null,modalTitle:"Внимание!",modalText:"",isModalWindowShowing:!1,showDangerAlert:!1,alertMessage:"",showSuccessAlert:!1}},methods:{loadAnnotations:function(){var e=dt(M.a.mark(function e(){var t,s,a,n=arguments;return M.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t=n.length>0&&void 0!==n[0]?n[0]:1,s=n.length>1&&void 0!==n[1]?n[1]:15,e.prev=2,this.isLoading=!0,e.next=6,ct.getAnnotations(t,s);case 6:a=e.sent,a&&a.isSuccessfully?(console.log(JSON.stringify(a)),this.tableData.items=a.data.annotations,this.annotationsTotalCount=a.data.totalAnnotationCount,this.goodsCountWithImages=a.data.withImages,this.goodsCountWithoutImages=a.data.withoutImages):(this.modalText=a.message,this.isModalWindowShowing=!0),e.next=15;break;case 10:e.prev=10,e.t0=e["catch"](2),this.modalText="Ошибка не удалось загрузить данные!",Object({NODE_ENV:"production",VUE_APP_BASE_URL:"/",BASE_URL:"/"}).VUE_APP_IS_DEV&&console.log(e.t0.toString()),this.isModalWindowShowing=!0;case 15:this.isLoading=!1;case 16:case"end":return e.stop()}},e,this,[[2,10]])}));function t(){return e.apply(this,arguments)}return t}(),updateAnnotation:function(){var e=dt(M.a.mark(function e(){var t,s=this;return M.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(e.prev=0,this.selectedAnnotation){e.next=3;break}throw new Error("Данные по аннотации пусты!");case 3:if(this.selectedAnnotation.annotationId){e.next=5;break}throw new Error("Не указан Id товара для текущей аннотации!");case 5:if(this.selectedAnnotation.drugName){e.next=7;break}throw new Error("Необходимо указать название товара!");case 7:if(this.selectedAnnotation.producer){e.next=9;break}throw new Error("Необходимо указать производителя!");case 9:return t=null,this.selectedAnnotation[this.editProperty]=this.textForEdit,e.next=13,ct.updateAnnotation(this.selectedAnnotation);case 13:t=e.sent,t.isSuccessfully?(this.alertMessage=t.message?t.message:"Данные по аннотации успешно сохранены!",this.showSuccessAlert=!0,this.selectedAnnotation<=0?setTimeout(function(){s.isAnnotationEditWindowShowing=!1,s.loadAnnotations(1,15)},3e3):setTimeout(function(){s.isAnnotationEditWindowShowing=!1},3e3)):(this.alertMessage=t.message?t.message:"Данные не сохранены!",this.showDangerAlert=!0),e.next=21;break;case 17:e.prev=17,e.t0=e["catch"](0),this.showDangerAlert=!0,this.alertMessage=e.t0.toString();case 21:case"end":return e.stop()}},e,this,[[0,17]])}));function t(){return e.apply(this,arguments)}return t}(),hideAlerts:function(){this.showDangerAlert=!1,this.showSuccessAlert=!1},editAnnotation:function(e,t){switch(t){case"usingWay":this.selectedAnnotation=e,this.editAnnotationPropertyText="Способ применения:",this.textForEdit=e.usingWay,this.editProperty="usingWay",this.isAnnotationEditWindowShowing=!0;break;case"forWhatIsUse":this.selectedAnnotation=e,this.editAnnotationPropertyText="Предназначение",this.textForEdit=e.forWhatIsUse,this.editProperty="forWhatIsUse",this.isAnnotationEditWindowShowing=!0;break;case"specialInstructions":this.selectedAnnotation=e,this.editAnnotationPropertyText="Спец. указания",this.textForEdit=e.specialInstructions,this.editProperty="specialInstructions",this.isAnnotationEditWindowShowing=!0;break;case"сontraIndicators":this.selectedAnnotation=e,this.editAnnotationPropertyText="Противопоказания",this.textForEdit=e.specialInstructions,this.editProperty="contraIndicators",this.isAnnotationEditWindowShowing=!0;break;case"sideEffects":this.selectedAnnotation=e,this.editAnnotationPropertyText="Побочные эффекты",this.textForEdit=e.sideEffects,this.editProperty="sideEffects",this.isAnnotationEditWindowShowing=!0;break}},chooseImg:function(){this.$refs.input_img.click()},imageSelected:function(){var e=dt(M.a.mark(function e(t){var s,a,n=this;return M.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(e.prev=0,t.target.files&&0!==t.target.files.length&&t.target.files[0]){e.next=3;break}return e.abrupt("return");case 3:if(this.selectedAnnotation){e.next=5;break}throw new Error("Данные по аннотации пусты!");case 5:if(this.selectedAnnotation.annotationId){e.next=7;break}throw new Error("Не указан Id товара для текущей аннотации!");case 7:return this.selectedImg=t.target.files[0],s=new FormData,this.selectedImg&&s.append("file",this.selectedImg),s.append("annotationId",this.selectedAnnotation.annotationId),this.modalText="Фото загружается на сервер подождите...",this.isModalWindowShowing=!0,e.next=15,ct.saveImage(s);case 15:a=e.sent,a.isSuccessfully?this.modalText="Фото успешно загружено на сервер!":this.modalText="Фото не загружено попробуйте ещё раз!",setTimeout(function(){n.isModalWindowShowing=!1,n.loadAnnotations(1,15)},3e3),e.next=24;break;case 20:e.prev=20,e.t0=e["catch"](0),this.modalText="Произошла ошибка во время сохранения изображения товара! Попробуйте ещё раз.",this.isModalWindowShowing=!0;case 24:case"end":return e.stop()}},e,this,[[0,20]])}));function t(t){return e.apply(this,arguments)}return t}()},watch:{currentPage:function(e){var t=1;t=this.actionTotalCount<e*this.dataRowsPerPage?this.actionTotalCount:e*this.dataRowsPerPage;var s=t-this.dataRowsPerPage+1;this.loadAnnotations(s,t)},showDangerAlert:function(e){e&&(this.showSuccessAlert=!1)},showSuccessAlert:function(e){e&&(this.showDangerAlert=!1)},alertMessage:function(e){e||(this.showDangerAlert=!1,this.showSuccessAlert=!1)},isAnnotationEditWindowShowing:function(e){e||(this.selectedAnnotation={},this.alertMessage="")},selectedAnnotation:function(e){e&&(this.annotationModalHeader="Товар: "+e.drugName+"<br>Производитель: "+e.producer)}}},ht=ut,gt=(s("32cd"),Object(h["a"])(ht,at,nt,!1,null,null,null)),ft=gt.exports,mt=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("nav-bar"),s("b-container",[s("b-form-group",{attrs:{label:"ID товара:","label-for":"goodId",description:"Идентификатор товара из 'Аналитики' для связи справочника бота"}},[s("b-form-input",{attrs:{id:"goodId",type:"number",required:"",placeholder:"ID товара"},model:{value:e.annotation.annotationId,callback:function(t){e.$set(e.annotation,"annotationId",t)},expression:"annotation.annotationId"}})],1),s("b-form-group",{attrs:{label:"Название товара","label-for":"goodName"}},[s("b-form-input",{attrs:{id:"goodName",type:"text",required:"",placeholder:"Название товара"},model:{value:e.annotation.drugName,callback:function(t){e.$set(e.annotation,"drugName",t)},expression:"annotation.drugName"}})],1),s("b-form-group",{attrs:{label:"Производитель","label-for":"producer"}},[s("b-form-input",{attrs:{id:"producer",type:"text",placeholder:"Производитель"},model:{value:e.annotation.producer,callback:function(t){e.$set(e.annotation,"producer",t)},expression:"annotation.producer"}})],1),s("b-form-group",{attrs:{label:"Способ применения","label-for":"usingWay"}},[s("b-form-textarea",{attrs:{id:"usingWay",rows:"5",placeholder:"Способ применения"},model:{value:e.annotation.usingWay,callback:function(t){e.$set(e.annotation,"usingWay",t)},expression:"annotation.usingWay"}})],1),s("b-form-group",{attrs:{label:"Предназначение","label-for":"forWhatIsUse"}},[s("b-form-textarea",{attrs:{id:"forWhatIsUse",rows:"3",placeholder:"Предназначение"},model:{value:e.annotation.forWhatIsUse,callback:function(t){e.$set(e.annotation,"forWhatIsUse",t)},expression:"annotation.forWhatIsUse"}})],1),s("b-form-group",{attrs:{label:"Спец. указания","label-for":"specialInstructions"}},[s("b-form-textarea",{attrs:{id:"specialInstructions",rows:"3",placeholder:"Спец. указания"},model:{value:e.annotation.specialInstructions,callback:function(t){e.$set(e.annotation,"specialInstructions",t)},expression:"annotation.specialInstructions"}})],1),s("b-form-group",{attrs:{label:"Противопоказания","label-for":"contraindicators"}},[s("b-form-textarea",{attrs:{id:"contraindicators",rows:"3",placeholder:"Противопоказания"},model:{value:e.annotation.contraIndicators,callback:function(t){e.$set(e.annotation,"contraIndicators",t)},expression:"annotation.contraIndicators"}})],1),s("b-form-group",{attrs:{label:"Побочные эффекты","label-for":"sideEffects"}},[s("b-form-textarea",{attrs:{id:"sideEffects",rows:"3",placeholder:"Побочные эффекты"},model:{value:e.annotation.sideEffects,callback:function(t){e.$set(e.annotation,"sideEffects",t)},expression:"annotation.sideEffects"}})],1),s("b-form-group",{attrs:{label:e.imageChoosed}},[s("b-form-file",{directives:[{name:"show",rawName:"v-show",value:e.isImageChooseShowing,expression:"isImageChooseShowing"}],ref:"imageInput",attrs:{state:Boolean(e.selectedImg),accept:"image/jpeg, image/png",placeholder:"Выберите изображение!","drop-placeholder":"Перетащите файл сюда!"},on:{change:e.imageSelected},model:{value:e.selectedImg,callback:function(t){e.selectedImg=t},expression:"selectedImg"}})],1),s("div",{staticClass:"submit-btn"},[s("b-button",{attrs:{variant:"danger"},on:{click:function(t){e.saveNewAnnotation(e.annotation)}}},[e._v("Сохранить данные по аннотации")])],1),s("b-alert",{attrs:{variant:"danger",dismissible:"",fade:"",show:e.showDangerAlert},on:{dismissed:function(t){e.showDangerAlert=!e.showDangerAlert}}},[e._v(e._s(e.alertMessage))]),s("b-alert",{attrs:{variant:"success",dismissible:"",fade:"",show:e.showSuccessAlert},on:{dismissed:function(t){e.showSuccessAlert=!e.showSuccessAlert}}},[e._v(e._s(e.alertMessage))])],1)],1)},pt=[];function wt(e,t,s,a,n,r,i){try{var o=e[r](i),c=o.value}catch(l){return void s(l)}o.done?t(c):Promise.resolve(c).then(a,n)}function bt(e){return function(){var t=this,s=arguments;return new Promise(function(a,n){var r=e.apply(t,s);function i(e){wt(r,a,n,i,o,"next",e)}function o(e){wt(r,a,n,i,o,"throw",e)}i(void 0)})}}var vt={components:{NavBar:W["default"]},data:function(){return{annotation:{annotationId:0,drugName:"",producer:"",usingWay:"",forWhatIsUse:"",specialInstructions:"",contraIndicators:"",sideEffects:"",isImageExists:!0,totalCountOfAnnotations:0},messageFromServer:"",selectedImg:null,img_src:"",imageChoosed:"Изображение не выбрано",imageLabelStyle:"color:red",showDangerAlert:!1,alertMessage:"",showSuccessAlert:!1,isImageChooseShowing:!0}},methods:{saveNewAnnotation:function(){var e=bt(M.a.mark(function e(){var t,s,a,n=this;return M.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(e.prev=0,this.annotation){e.next=3;break}throw new Error("Данные по аннотации пусты!");case 3:if(this.annotation.annotationId){e.next=5;break}throw new Error("Не указан Id товара для текущей аннотации!");case 5:if(this.annotation.drugName){e.next=7;break}throw new Error("Необходимо указать название товара!");case 7:if(this.annotation.producer){e.next=9;break}throw new Error("Необходимо указать производителя!");case 9:for(a in t=null,this.alertMessage="Загрузка данных по аннотации на сервер...",this.showDangerAlert=!0,s=new FormData,this.selectedImg&&s.append("file",this.selectedImg),this.annotation)s.append(a,this.annotation[a]);return e.next=17,ct.saveNewAnnotation(s);case 17:t=e.sent,t.isSuccessfully?(this.alertMessage=t.message?t.message:"Данные по аннотации успешно сохранены!",this.showSuccessAlert=!0,this.annotation.annotationId<=0?setTimeout(function(){n.isAnnotationEditWindowShowing=!1,n.loadAnnotations(1,15)},3e3):setTimeout(function(){n.isAnnotationEditWindowShowing=!1},3e3)):(this.alertMessage=t.message?t.message:"Данные не сохранены!",this.showDangerAlert=!0),e.next=25;break;case 21:e.prev=21,e.t0=e["catch"](0),this.showDangerAlert=!0,this.alertMessage=e.t0.toString();case 25:case"end":return e.stop()}},e,this,[[0,21]])}));function t(){return e.apply(this,arguments)}return t}(),imageSelected:function(e){e.target.files&&0!==e.target.files.length&&e.target.files[0]&&(this.isImageChooseShowing=!0,this.selectedImg=e.target.files[0])}},watch:{selectedImg:function(e){e&&(this.imageChoosed="Изображение товара выбрано",this.imageLabelStyle="color:#33bc2e;")},showDangerAlert:function(e){e&&(this.showSuccessAlert=!1)},showSuccessAlert:function(e){e&&(this.showDangerAlert=!1)},alertMessage:function(e){e||(this.showDangerAlert=!1,this.showSuccessAlert=!1)}}},St=vt,At=(s("328c"),Object(h["a"])(St,mt,pt,!1,null,null,null)),xt=At.exports,_t=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("nav-bar"),s("loading",{attrs:{isLoading:e.isLoading}}),e.isLoading?e._e():s("b-container",[s("b-table",{attrs:{"primary-key":"chatId",bordered:"",hover:"",fields:e.tableData.fields,items:e.tableData.items,"head-variant":"light",responsive:"","caption-top":""},scopedSlots:e._u([{key:"isUserWantsToGetUpdates",fn:function(t){return[s("a",{attrs:{href:"#"},on:{click:function(s){e.selectedCard=t.item,e.askAndChangePropValue("Вы уверены что хотите изменить условие получение новостей пользователем?","isUserWantsToGetUpdates")}}},[!0===t.item.isUserWantsToGetUpdates?s("i",{staticClass:"material-icons done_all"},[e._v("done_all")]):s("i",{staticClass:"material-icons done"},[e._v("done")])])]}},{key:"isRegistered",fn:function(t){return[s("a",{attrs:{href:"#"},on:{click:function(s){e.selectedCard=t.item,e.askAndChangePropValue("Вы уверены что хотите активировать карту? Пользователю будет отправлено сообщение!","isRegistered")}}},[!0===t.item.isRegistered?s("i",{staticClass:"material-icons done_all"},[e._v("done_all")]):s("i",{staticClass:"material-icons done"},[e._v("done")])])]}}])},[s("template",{slot:"table-caption"},[s("strong",{staticClass:"text-danger"},[e._v("Кол-во данных по дисконт картам: "+e._s(e.discountCardsTotalCount))])])],2),s("b-pagination",{staticStyle:{"margin-bottom":"5%"},attrs:{align:"center","total-rows":e.discountCardsTotalCount,"per-page":e.dataRowsPerPage,limit:8},model:{value:e.currentPage,callback:function(t){e.currentPage=t},expression:"currentPage"}}),s("b-modal",{attrs:{title:e.modalTitle,centered:"","cancel-disabled":""},model:{value:e.isModalWindowShowing,callback:function(t){e.isModalWindowShowing=t},expression:"isModalWindowShowing"}},[s("p",[e._v(e._s(e.modalText))])]),s("b-modal",{attrs:{size:"lg",title:e.modalTitle,centered:""},model:{value:e.isQuestionModalWindowShowing,callback:function(t){e.isQuestionModalWindowShowing=t},expression:"isQuestionModalWindowShowing"}},[s("b-container",[s("h3",[e._v(e._s(e.modalText))]),s("b-alert",{attrs:{variant:"danger",dismissible:"",fade:"",show:e.showDangerAlert},on:{dismissed:function(t){e.showDangerAlert=!e.showDangerAlert}}},[e._v(e._s(e.alertMessage))]),s("b-alert",{attrs:{variant:"success",dismissible:"",fade:"",show:e.showSuccessAlert},on:{dismissed:function(t){e.showSuccessAlert=!e.showSuccessAlert}}},[e._v(e._s(e.alertMessage))])],1),s("div",{staticClass:"w-100 text-right",attrs:{slot:"modal-footer"},slot:"modal-footer"},[s("b-button",{attrs:{size:"md",variant:"danger"},on:{click:e.updateCardData}},[e._v("Подтвердить")]),s("b-button",{attrs:{size:"md"},on:{click:function(t){e.isQuestionModalWindowShowing=!1}}},[e._v("Отмена")])],1)],1)],1)],1)},yt=[];function kt(e,t,s,a,n,r,i){try{var o=e[r](i),c=o.value}catch(l){return void s(l)}o.done?t(c):Promise.resolve(c).then(a,n)}function Et(e){return function(){var t=this,s=arguments;return new Promise(function(a,n){var r=e.apply(t,s);function i(e){kt(r,a,n,i,o,"next",e)}function o(e){kt(r,a,n,i,o,"throw",e)}i(void 0)})}}var Pt={data:[],message:"",isSuccessfully:!1},Dt={getCards:function(){var e=Et(M.a.mark(function e(t,s){var n,r,i=arguments;return M.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(n=i.length>2&&void 0!==i[2]?i[2]:"/api/discount?beginPage=",e.prev=1,t&&s){e.next=4;break}throw new Error("Couldn't load users because begin or end page not specified!");case 4:if(n){e.next=6;break}throw new Error("Couldn't get users data because url parameter not specified!");case 6:return n=n+t+"&endPage="+s,e.next=9,a["a"].axios.get(n);case 9:r=e.sent,r&&r.data?(Pt.data=r.data?r.data:[],Pt.message=r.data.message?r.data.message:"200. Данные успешно получены!",Pt.isSuccessfully=!0):(Pt.data=[],Pt.message=r.data.message?r.data.message:"Данные не получены!",Pt.isSuccessfully=!1),e.next=18;break;case 13:e.prev=13,e.t0=e["catch"](1),Pt.data=[],Object({NODE_ENV:"production",VUE_APP_BASE_URL:"/",BASE_URL:"/"}).VUE_APP_IS_DEV?Pt.message=JSON.stringify(e.t0):Pt.message=e.t0.response.data?e.t0.response.data:"Данные не получены!",Pt.isSuccessfully=!1;case 18:return e.abrupt("return",Pt);case 19:case"end":return e.stop()}},e,this,[[1,13]])}));function t(t,s){return e.apply(this,arguments)}return t}(),updateCardData:function(){var e=Et(M.a.mark(function e(t){var s,n,r=arguments;return M.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(s=r.length>1&&void 0!==r[1]?r[1]:"/api/discount",e.prev=1,t){e.next=4;break}throw new Error("Couldn't save card data! Discount card data is null or undefined!");case 4:if(s){e.next=6;break}throw new Error("Couldn't save discount card data because url parameter not specified!");case 6:n=a["a"].axios.post(s,t),Pt.isSuccessfully=!0,Pt.message="Данные успешно обновлены!",n&&n.data&&(Pt.message=n.data.message?n.data.message:Pt.message),e.next=16;break;case 12:e.prev=12,e.t0=e["catch"](1),Object({NODE_ENV:"production",VUE_APP_BASE_URL:"/",BASE_URL:"/"}).VUE_APP_IS_DEV?Pt.message=JSON.stringify(e.t0):Pt.message=e.t0.response.data?e.t0.response.data:"Данные не обновлены!",Pt.isSuccessfully=!1;case 16:return e.abrupt("return",Pt);case 17:case"end":return e.stop()}},e,this,[[1,12]])}));function t(t){return e.apply(this,arguments)}return t}()};function It(e,t,s,a,n,r,i){try{var o=e[r](i),c=o.value}catch(l){return void s(l)}o.done?t(c):Promise.resolve(c).then(a,n)}function Ct(e){return function(){var t=this,s=arguments;return new Promise(function(a,n){var r=e.apply(t,s);function i(e){It(r,a,n,i,o,"next",e)}function o(e){It(r,a,n,i,o,"throw",e)}i(void 0)})}}var Ut={components:{NavBar:W["default"],Loading:ge},created:function(){this.loadCards(1,15)},data:function(){return{tableData:{fields:[{key:"chatId",label:"Id в ТГ",sortable:!0},{key:"cardId",label:"Id карты",sortable:!0},{key:"userFIO",label:"Имя клиента",sortable:!0},{key:"birthDate",label:"Дата рождения",sortable:!0},{key:"phone",label:"Телефон",sortable:!0},{key:"email",label:"Email",sortable:!0},{key:"dateTimeEntered",label:"Дата получения данных ботом",sortable:!0},{key:"isUserWantsToGetUpdates",label:"Клиент подписан на новости",sortable:!0},{key:"isRegistered",label:"Карта активирована",sortable:!0}],items:[]},discountCardsTotalCount:0,isLoading:!1,modalTitle:"Внимание!",modalText:"",isModalWindowShowing:!1,currentPage:1,dataRowsPerPage:15,isQuestionModalWindowShowing:!1,selectedCard:{},showDangerAlert:!1,alertMessage:"",showSuccessAlert:!1,updatedProperty:null}},methods:{loadCards:function(){var e=Ct(M.a.mark(function e(){var t,s,a,n=arguments;return M.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t=n.length>0&&void 0!==n[0]?n[0]:1,s=n.length>1&&void 0!==n[1]?n[1]:15,e.prev=2,this.isLoading=!0,e.next=6,Dt.getCards(t,s);case 6:a=e.sent,a&&a.isSuccessfully?(this.tableData.items=a.data.discounts,this.discountCardsTotalCount=a.data.totalCount):(this.modalText=a.message,this.isModalWindowShowing=!0),e.next=15;break;case 10:e.prev=10,e.t0=e["catch"](2),this.modalText="Ошибка не удалось загрузить данные!",Object({NODE_ENV:"production",VUE_APP_BASE_URL:"/",BASE_URL:"/"}).VUE_APP_IS_DEV&&console.log(e.t0.toString()),this.isModalWindowShowing=!0;case 15:this.isLoading=!1;case 16:case"end":return e.stop()}},e,this,[[2,10]])}));function t(){return e.apply(this,arguments)}return t}(),updateCardData:function(){var e=Ct(M.a.mark(function e(){var t;return M.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(e.prev=0,this.selectedCard&&this.selectedCard.cardId){e.next=3;break}throw new Error("Данные по карте не указаны!");case 3:if(this.selectedCard.chatId){e.next=5;break}throw new Error("Id пользователя в телеграме не определено!");case 5:return this.selectedCard[this.updatedProperty]=!this.selectedCard[this.updatedProperty],e.next=8,Dt.updateCardData(this.selectedCard);case 8:if(t=e.sent,!t.isSuccessfully){e.next=17;break}return this.alertMessage=t.message?t.message:"Данные успешно обновлены!",e.next=13,this.sendMessage();case 13:this.showSuccessAlert=!0,this.isQuestionModalWindowShowing=!1,e.next=19;break;case 17:this.alertMessage=t.message?t.message:"Данные не обновлены!",this.showDangerAlert=!0;case 19:e.next=25;break;case 21:e.prev=21,e.t0=e["catch"](0),this.showDangerAlert=!0,this.alertMessage=e.t0.toString();case 25:this.updatedProperty=null;case 26:case"end":return e.stop()}},e,this,[[0,21]])}));function t(){return e.apply(this,arguments)}return t}(),askAndChangePropValue:function(e,t){this.modalText=e,this.isQuestionModalWindowShowing=!0,this.updatedProperty=t},sendMessage:function(){var e=Ct(M.a.mark(function e(){var t;return M.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(e.prev=0,t="","isRegistered"!==this.updatedProperty){e.next=6;break}t=!0===this.selectedCard.isRegistered?"✅✅✅Ваша дисконтная карта успешно зарегистрирована в системе! Теперь Вы можете использовать её в аптеках OXYmed!\n➖➖➖➖➖➖➖➖➖➖➖\n✅✅✅Sizning diskont kartangiz tizimda muvaffaqiyatli ro'yxatdan o'tgan! Endi Siz OXYmed dorixonalarida undan foydalanishingiz mumkin!":"❌Ваша дисконтная карта заблокирована!❌\n➖➖➖➖➖➖➖➖➖➖➖\n❌Sizning diskont kartangiz bekor qilindi!❌",e.next=11;break;case 6:if("isUserWantsToGetUpdates"!==this.updatedProperty){e.next=10;break}t=!0===this.selectedCard.isUserWantsToGetUpdates?"👍Вы подписаны на получение новостных сообщений!\n➖➖➖➖➖➖➖➖➖➖➖\n👍Yangiliklarni qabul qilish uchun obuna bo'lgansiz!":"❌Вы отписаны от новостных сообщений!❌\n➖➖➖➖➖➖➖➖➖➖➖\n❌Sizning xabar obunangiz bekor qilindi!❌",e.next=11;break;case 10:throw new Error("This type of property is not recognized!");case 11:return e.next=13,oe.sendMessageToUser(t,this.selectedCard.chatId);case 13:e.next=19;break;case 15:e.prev=15,e.t0=e["catch"](0),this.showDangerAlert=!0,this.alertMessage=e.t0.toString();case 19:case"end":return e.stop()}},e,this,[[0,15]])}));function t(){return e.apply(this,arguments)}return t}()},watch:{currentPage:function(e){var t=1;t=this.discountCardsTotalCount<e*this.dataRowsPerPage?this.discountCardsTotalCount:e*this.dataRowsPerPage;var s=t-this.dataRowsPerPage+1;this.loadCards(s,t)},showDangerAlert:function(e){e&&(this.showSuccessAlert=!1)},showSuccessAlert:function(e){e&&(this.showDangerAlert=!1)},alertMessage:function(e){e||(this.showDangerAlert=!1,this.showSuccessAlert=!1)},isQuestionModalWindowShowing:function(e){e||(this.selectedCard={},this.alertMessage="")}}},Mt=Ut,Wt=(s("34d4"),Object(h["a"])(Mt,_t,yt,!1,null,null,null)),Tt=Wt.exports;a["a"].use(p["a"]);var Nt=new p["a"]({mode:"history",base:"/",routes:[{path:"/",name:"login",component:D},{path:"/api/send/msg",name:"sendMessageToUsers",component:q},{path:"/api/send/img",name:"sendImage",component:te},{path:"/api/user",component:ve,name:"users"},{path:"/api/actions",component:Ue,name:"actions"},{path:"/api/drugstore",component:$e,name:"drugStores"},{path:"/api/request",component:st,name:"userRequests"},{path:"/api/annotation",component:ft,name:"annotations"},{path:"/api/annotation/create",component:xt,name:"annotation_create"},{path:"/api/discount",component:Tt,name:"discount_card"}],linkActiveClass:"active",linkExactActiveClass:"active"});a["a"].config.productionTip=!1;var Lt=sessionStorage.getItem("userToken");Lt&&(a["a"].axios.defaults.headers.common["Authorization"]=Lt),new a["a"]({router:Nt,render:function(e){return e(m)}}).$mount("#app")},"5ba7":function(e,t,s){"use strict";var a=s("0dd2"),n=s.n(a);n.a},6299:function(e,t,s){"use strict";var a=s("87c1"),n=s.n(a);n.a},"64a9":function(e,t,s){},"7e23":function(e,t,s){"use strict";var a=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("b-navbar",{attrs:{type:"dark",variant:"primary",toggleable:"",fixed:"top"}},[s("b-navbar-toggle",{attrs:{target:"nav_dropdown_collapse"}}),s("b-navbar-brand",{attrs:{to:"/api/send/msg"}},[e._v("OxyMed")]),s("b-collapse",{attrs:{"is-nav":"",id:"nav_dropdown_collapse"}},[s("b-navbar-nav",[s("b-nav-item",{attrs:{to:"/api/send/msg"}},[s("span",[e._v("Рассылка сообщения")])]),s("b-nav-item",{attrs:{to:"/api/send/img"}},[s("span",[e._v("Рассылка изображения или файла")])]),s("b-nav-item",{attrs:{to:"/api/discount"}},[s("span",[e._v("Клиенты с дисконт картами")])]),s("b-nav-item",{attrs:{to:"/api/user"}},[s("span",[e._v("Список пользователей")])]),s("b-nav-item-dropdown",{attrs:{text:"Доп. опции",left:""}},[s("b-dropdown-item",{attrs:{to:"/api/actions"}},[e._v("Акции и скидки")]),s("b-dropdown-item",{attrs:{to:"/api/drugstore"}},[e._v("Редактировать данные аптек")]),s("b-dropdown-item",{attrs:{to:"/api/request"}},[e._v("Запросы пользователей")]),s("b-dropdown-item",{attrs:{to:"/api/annotation"}},[e._v("Аннотации")])],1)],1)],1)],1)},n=[];s.d(t,"a",function(){return a}),s.d(t,"b",function(){return n})},"87c1":function(e,t,s){},9769:function(e,t,s){},"97b3":function(e,t,s){},"990b":function(e,t,s){},"9e76":function(e,t,s){},"9f48":function(e,t,s){"use strict";var a=s("97b3"),n=s.n(a);n.a},ac98:function(e,t,s){},b90a:function(e,t,s){},bd61:function(e,t,s){"use strict";var a=s("7e23"),n=s("d115"),r=(s("d75c"),s("2877")),i=Object(r["a"])(n["default"],a["a"],a["b"],!1,null,null,null);t["default"]=i.exports},cf05:function(e,t,s){e.exports=s.p+"img/logo.dc18d103.png"},d115:function(e,t,s){"use strict";var a=s("f599"),n=s.n(a);t["default"]=n.a},d75c:function(e,t,s){"use strict";var a=s("9769"),n=s.n(a);n.a},df10:function(e,t,s){},e46e:function(e,t,s){"use strict";var a=s("b90a"),n=s.n(a);n.a},f599:function(e,t){},f8d1:function(e,t,s){"use strict";var a=s("034d"),n=s.n(a);n.a}});
//# sourceMappingURL=app.8de59041.js.map